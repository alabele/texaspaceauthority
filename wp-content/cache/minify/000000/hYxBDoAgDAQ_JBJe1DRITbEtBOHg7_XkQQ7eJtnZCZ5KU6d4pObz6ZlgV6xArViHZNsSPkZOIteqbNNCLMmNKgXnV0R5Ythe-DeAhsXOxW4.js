var gmapdata=new Array();var gmapmarker=new Array();function if_gmap_init(id,form_id)
{if(document.getElementById(id+"_element"+form_id)){map=document.getElementById(id+"_element"+form_id);var def_zoomval=parseInt(map.getAttribute("zoom"));var def_longval=map.getAttribute("center_x");var def_latval=map.getAttribute("center_y");var curpoint=new google.maps.LatLng(def_latval,def_longval);gmapdata[id]=new google.maps.Map(document.getElementById(id+"_element"+form_id),{center:curpoint,zoom:def_zoomval,mapTypeId:'roadmap'});gmapmarker[id]=new Array();return false;}
else
{draggab=false;map=document.getElementById(id);var def_zoomval=parseInt(map.getAttribute("zoom"));var def_longval=map.getAttribute("long");var def_latval=map.getAttribute("lat");var curpoint=new google.maps.LatLng(def_latval,def_longval);gmapdata=new google.maps.Map(document.getElementById(id),{center:curpoint,zoom:def_zoomval,mapTypeId:'roadmap'});geocoder=new google.maps.Geocoder();gmapmarker=new google.maps.Marker({map:gmapdata,position:curpoint,draggable:draggab});gmapmarker.setDraggable(draggab);infoW=new google.maps.InfoWindow;google.maps.event.addListener(gmapdata,'mouseover',function(event)
{if(!document.getElementById("longval"))
gmapmarker.draggable=false;});google.maps.event.addListener(gmapdata,'click',function(event){if(document.getElementById("longval"))
{document.getElementById("longval").value=event.latLng.lng().toFixed(6);document.getElementById("latval").value=event.latLng.lat().toFixed(6);gmapmarker.setPosition(event.latLng);if_gmap_updateMap();geocoder.geocode({'latLng':gmapmarker.getPosition()},function(results,status)
{if(status==google.maps.GeocoderStatus.OK)
{if(results[0])
{if(document.getElementById("addrval"))document.getElementById("addrval").value=results[0].formatted_address;}}});}});google.maps.event.addListener(gmapmarker,'drag',function(){if(document.getElementById("longval"))
{geocoder.geocode({'latLng':gmapmarker.getPosition()},function(results,status)
{if(status==google.maps.GeocoderStatus.OK)
{if(results[0])
{if(document.getElementById("addrval"))document.getElementById("addrval").value=results[0].formatted_address;}}});if_gmap_updateMap();document.getElementById("latval").value=gmapmarker.getPosition().lat().toFixed(6);document.getElementById("longval").value=gmapmarker.getPosition().lng().toFixed(6);}});google.maps.event.addListener(gmapmarker,'click',function(){infoW.setContent('<div style="overflow: hidden;">'+document.getElementById(id).getAttribute('info')+"</div>");var infoWOpt={maxWidth:"300"};infoW.setOptions(infoWOpt);infoW.open(this.getMap(),this);});if(document.getElementById("longval"))
{document.getElementById("longval").value=def_longval;document.getElementById("latval").value=def_latval;geocoder.geocode({'latLng':gmapmarker.getPosition()},function(results,status){if(status==google.maps.GeocoderStatus.OK){if(results[0]){if(document.getElementById("addrval"))document.getElementById("addrval").value=results[0].formatted_address;}}});}
return false;}}
function add_marker_on_map(id,i,w_long,w_lat,w_info,form_id,dragb)
{var marker_point=new google.maps.LatLng(w_lat,w_long);gmapmarker[id][i]=new google.maps.Marker({map:gmapdata[id],position:marker_point,draggable:dragb});gmapmarker[id][i].setDraggable(dragb);if(dragb)
{google.maps.event.addListener(gmapmarker[id][i],'drag',function()
{document.getElementById(id+"_lat"+form_id).value=gmapmarker[id][i].getPosition().lat().toFixed(6);document.getElementById(id+"_long"+form_id).value=gmapmarker[id][i].getPosition().lng().toFixed(6);});}
infoW=new google.maps.InfoWindow;google.maps.event.addListener(gmapmarker[id][i],'click',function()
{infoW.setContent('<div style="overflow: hidden;">'+document.getElementById(id+"_element"+form_id).getAttribute('info'+i)+"</div>");var infoWOpt={maxWidth:"300"};infoW.setOptions(infoWOpt);infoW.open(this.getMap(),this);});return false;};(function(){var au=window.JELLY={},ay=window,K=ay.document,aR=K.documentElement,F=K.getElementsByTagName("head")[0],N="addEventListener"in K,S="querySelectorAll"in K,W=function(){},aK=function(){var J=ay.navigator,a5=J.userAgent,bb="ActiveXObject"in ay,bc="XMLHttpRequest"in ay,a8="securityPolicy"in J,a7="taintEnabled"in J,a6=/opera/i.test(a5),a9=/firefox/i.test(a5),ba=/webkit/i.test(a5),Q=bb?(S?8:(bc?7:6)):0;return{ie:Q,ie6:Q===6,ie7:Q===7,ie8:Q===8,opera:a6,firefox:a9||(a8&&!bb&&!a6),webkit:ba||(!a7&&!bb&&!a6),safariMobile:/safari/i.test(a5)&&/mobile/i.test(a5),chrome:ba&&/chrome/i.test(a5)}}(),aB=aK.ie,aA=function(J){return typeof J!=="undefined"},Y=function(J){return typeof J==="undefined"},a1=function(J){return J===null},aQ=function(J){return typeof J==="boolean"},aY=function(J){return typeof J==="string"},U=function(J){return typeof J==="number"},ap=function(J){return U(J)?!(J%1):false},b=function(J){return U(J)?!!(J%1):false},p=function(J){return aY(J)||U(J)?/^\s*\d+\.?\d*?\s*$/.test((J+"")):false},H=function(J){return J+""==="[object Object]"},c=function(J){return!!J&&!H(J)&&(typeof J==="object"||aL(J))},aL=function(J){return{}.toString.call(J)==="[object Function]"},az=function(){if(!aB){return function(J){return c(J)&&!a(J)&&/^\[object HTML[A-Za-z]*Element\]$/.test(J+"")}}return function(J){return c(J)&&!!J.nodeName&&J.nodeType===1}}(),a0=function(){if(!aB){return function(J){return aI(J)&&/^\[object (HTMLCollection|NodeList)\]$/.test(J+"")}}return function(J){return aI(J)&&!!J.item}}(),a=function(J){return{}.toString.call(J)==="[object Array]"},aI=function(J){return c(J)&&!H(J)&&!a(J)&&!aL(J)&&ap(J.length)},x=function(Q,J){return J.indexOf(Q)!==-1},O=function(a5){var J=[],a6=a5.length,Q=0;for(Q;Q<a6;Q++){J[Q]=a5[Q]}return J},aN=function(J){if(aY(J)){return/^\s*$/.test(J)}else{if(a(J)){return!J.length}else{if(H(J)){return!Object.keys(J).length}}}return!J},av=function(Q,J,a5){for(var a6 in J){if(Y(Q[a6])||aA(Q[a6])&&a5!==false){Q[a6]=J[a6]}}return Q},aq=function(){var J=O(arguments),a5=J.shift(),Q=J.shift();return setTimeout(function(){a5.apply(Q,J)},0)},h=function(Q){var J=ay.console;if(J&&J[Q]){return function(){J[Q].apply(J,O(arguments))}}return W},d=h("log"),aH=h("warn"),ab=h("error");av(au,{browser:aK,isDefined:aA,isUndefined:Y,isNull:a1,isBoolean:aQ,isString:aY,isNumber:U,isInteger:ap,isFloat:b,isNumeric:p,isObject:H,isFunction:aL,isElement:az,isNodeList:a0,isArray:a,toArray:O,empty:aN,extend:av,log:d,logWarn:aH,logError:ab});av(Array.prototype,{forEach:function(Q,a5){for(var J=0,a6=this.length;J<a6;J++){Q.call(a5,this[J],J,this)}},indexOf:function(Q,a6){a6=aA(a6)?(a6<0?Math.max(0,this.length+a6):a6):0;for(var J=a6,a5=this.length;J<a5;J++){if(this[J]===Q){return J}}return-1},filter:function(a5,a6){for(var Q=0,a7=this.length,J=[];Q<a7;Q++){if(a5.call(a6,this[Q],Q,this)){J.push(this[Q])}}return J},map:function(a5,a6){for(var Q=0,a7=this.length,J=[];Q<a7;Q++){J.push(a5.call(a6,this[Q],Q,this))}return J},some:function(Q,a5){for(var J=0,a6=this.length;J<a6;J++){if(Q.call(a5,this[J],J,this)){return true}}return false},every:function(Q,a5){for(var J=0,a6=this.length;J<a6;J++){if(!Q.call(a5,this[J],J,this)){return false}}return true}},false);Array.prototype.each=Array.prototype.forEach;av(String.prototype,{trim:function(){return this.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}},false);av(Function.prototype,{bind:function(){if(arguments.length<2&&!aA(arguments[0])){return this}var J=O(arguments),a5=J.shift(),Q=this;return function(){for(var a7=0,a6=O(J);arguments.length>a7;a7++){a6.push(arguments[a7])}return Q.apply(a5,a6)}}},false);if(ay.HTMLElement&&HTMLElement.prototype){av(HTMLElement.prototype,{contains:function(J){return!!(this.compareDocumentPosition(J)&16)}},false)}av(Object,{keys:function(a5){var Q=[],J;for(J in a5){if(a5.hasOwnProperty(J)){Q.push(J)}}return Q}},false);var aE=function(a6,a8){var J=a8.__init||function(){},a5=a8.__static||{},a7=a8.__extends,Q=J.prototype;av(Q,o);(a(a7)?a7:(a7?[a7]:[])).each(function(a9){av(Q,a9.prototype);J.__parent=a9});av(J,a5);["__init","__static","__extends"].each(function(a9){delete a8[a9]});av(Q,a8);Q.constructor=J;J.__name=a6;au[a6]=J;return J},o={fireEvent:function(){var J=O(arguments),a5="on"+I(J.shift()),Q=this[a5];if(aN(J)){J.push(this)}return Q?Q.apply(this,J):false},isInstanceOf:function(){return this.constuctor.__name},set:function(Q,J){var a5=this;if(H(Q)){return av(a5,Q)}a5[Q]=J;return a5}};au.defineClass=aE;var aa=function(J,Q){return J.indexOf(Q)!==-1},aS=function(J){return J.replace(/\s{2,}/g," ").trim()},I=function(J,Q){return J.replace(Q?/^\s*[a-z]/:/(^|\s+)[a-z]/g,function(a5){return a5.toUpperCase()})},g=function(J){return J.replace(/-([a-z])/g,function(Q,a5){return a5.toUpperCase()})},aW=function(a7){var J=a7.match(/[\d]{1,3}/g),a5=[],Q=0;for(Q;Q<3;Q++){var a6=(J[Q]-0).toString(16);a5.push(a6.length===1?"0"+a6:a6)}return"#"+a5.join("")},ah=function(a6,a7){var a5=a6.match(/^#([\w]{1,2})([\w]{1,2})([\w]{1,2})$/),J=[],Q=1;for(Q;Q<a5.length;Q++){if(a5[Q].length===1){a5[Q]+=a5[Q]}J.push(parseInt(a5[Q],16))}return a7?J:"rgb("+J.join(",")+")"},aU=function(a7,a6){var Q=/^#/.test(a7),a5=[],J;switch(a6){case"hex":return Q?a7:aW(a7);case"rgb":return Q?ah(a7):a7;case"rgb-array":if(Q){return ah(a7,true)}else{J=a7.replace(/rgb| |\(|\)/g,"").split(",");J.each(function(a8){a5.push(parseInt(a8,10))});return a5}}},aO=function(Q,J){if(!J){return Q.replace(/<[^>]*>/g,"")}J=J.replace(/\s+/g,"").split(",").map(function(a5){return a5+" |"+a5+">|/"+a5+">"}).join("|");return Q.replace(new RegExp("<(?!"+J+")[^>]+>","g"),"")},aF=function(a5,Q){var J;while(J=/%\{\s*([^\}\s]+)\s*\}/.exec(a5)){a5=a5.replace(J[0],Q[J[1]]||"??")}return a5},f=function(Q){var a5=ao("div",{setHTML:Q}),J=[];O(R(a5,"script")).each(function(a6){J.push(ay["eval"](a6.innerHTML))});return J};av(au,{contains:aa,normalize:aS,capitalize:I,camelize:g,parseColour:aU,stripTags:aO,bindData:aF,evalScripts:f});var aX=function(J,Q){J=aC(J);if(a4(J,Q)){return}J.className+=J.className?" "+Q:Q},aZ=function(J,a5){J=aC(J);if(!J.className){return}var Q=new RegExp("(^|\\s)"+a5+"(\\s|$)");J.className=aS(J.className.replace(Q," "))},a4=function(J,Q){return(" "+(aC(J)).className+" ").indexOf(Q)!==-1},z=function(J,Q){J=aC(J);if(a4(J,Q)){aZ(J,Q)}else{aX(J,Q)}},aC=function(J){return typeof J==="string"?K.getElementById(J):J},R=function(Q,J){return(J?aC(Q):K).getElementsByTagName(J||Q)},ao=function(bg,be){var Q;if(!/[#:\.]/.test(bg)){Q=K.createElement(bg),ar;for(ar in be){switch(ar){case"setHTML":Q.innerHTML=be[ar];break;case"setText":Q.appendChild(K.createTextNode(be[ar]));break;case"class":Q.className=be[ar];break;case"style":Q.style.cssText=be[ar];break;default:Q.setAttribute(ar,be[ar])}}}else{var bg=bg.trim(),a6="__JELLY_CE__",bd=[],a5;while(a5=/('|")([^\1]*?)\1/.exec(bg)){bg=bg.replace(a5[0],a6);bd.push(a5[2])}bg=bg.replace(/\s*(:|,)\s*/g,"$1");var a8=bg.split(" "),ba=a8.shift(),J=ba.indexOf("#")!==-1,bf=ba.indexOf(".")!==-1,bb="div",a7={},bc=null,a9;if(J||bf){a9=J?ba.split("#"):ba.split(".");bb=a9.shift()||bb;a7[J?"id":"class"]=a9.join(" ")}else{bb=ba}if(a8[0]){a8[0].split(",").each(function(bh){bh=bh.split(":");var bi=bh[1]===a6?bd.shift():bh[1];if(bh[0]==="@"){bc=bi}else{a7[bh[0]]=bi}})}Q=ao(bb.toLowerCase(),a7)}return be===true?{elem:Q,ref:bc}:Q},a2=function(){var J=O(arguments),a5={},Q,a6=function(a7){if(a7&&H(a7)){if(az(a7.root)){for(var a8 in a7){if(a(a7[a8])){var bc=a7[a8][0].nodeName.toLowerCase();a5[bc]=a5[bc]||[];a7[a8].each(function(bd){a5[bc].push(bd)})}else{if(a8!=="root"){a5[a8]=a7[a8]}}}return a7.root}else{if(az(a7)){return a7}}}else{if(!aY(a7)){return}}var bb=ao(a7,true),ba=bb.elem,a9=ba.nodeName.toLowerCase();a5[a9]=a5[a9]||[];a5[a9].push(ba);if(bb.ref){a5[bb.ref]=ba}return ba};a5.root=Q=a6(J.shift());J.each(function(a7){if(!a(a7)){Q=Q.appendChild(a6(a7))}else{a7.each(function(a8){Q.appendChild(a6(a8))})}});return a5},aD=function(Q,a6){Q=aC(Q);var a5=Q.parentNode,J=Q.nextSibling;a6.appendChild(Q);return J?a5.insertBefore(a6,J):a5.appendChild(a6)},l=function(Q,a5,J){Q=aC(Q);if(Q){return a5.call(J||Q,Q)}return Q},ak=function(Q,J){Q=aC(Q);return Q.parentNode.replaceChild(J,Q)},y=function(J){J=aC(J);return J.parentNode.removeChild(J)},aV=function(Q,J){Q=aC(Q);return(aC(J)||K.body).appendChild(Q)},j=function(Q,J){if(!(Q=aC(Q))||!(J=aC(J))){return false}if(J.firstChild){return J.insertBefore(Q,J.firstChild)}else{return J.appendChild(Q)}},an=function(Q,J){J=aC(J);return J.parentNode.insertBefore(aC(Q),J)},C=function(a5,J){if(!(a5=aC(a5))||!(J=aC(J))){return false}var Q=au.getNext(J);if(Q){return J.parentNode.insertBefore(a5,Q)}else{return J.parentNode.appendChild(a5)}},aT=function(J){J=J.firstChild;while(J&&J.nodeType!==1){J=J.nextSibling}return J},v=function(J){J=J.lastChild;while(J&&J.nodeType!==1){J=J.previousSibling}return J},M=function(J){J=J.nextSibling;while(J&&J.nodeType!==1){J=J.nextSibling}return J},at=function(J){J=J.previousSibling;while(J&&J.nodeType!==1){J=J.previousSibling}return J},D=function(J){var Q=[],J=J.firstChild;while(J){if(J.nodeType===1){Q[Q.length]=J}J=J.nextSibling}return Q},aM=function(Q){Q=aC(Q);var a8=[0,0];if(!Q){return a8}if("getBoundingClientRect"in Q){var a5=Q.getBoundingClientRect(),J=A(),a7=a5.left,a6=a5.top;a8=[a7+J[0],a6+J[1]]}else{a8=[Q.offsetLeft,Q.offsetTop];while(Q=Q.offsetParent){a8[0]+=Q.offsetLeft;a8[0]+=parseInt(aG(Q,"border-left-width"))||0;a8[1]+=Q.offsetTop;a8[1]+=parseInt(aG(Q,"border-top-width"))||0}}return a8},am=function(J,a6,a5,Q){J=aC(J);Q=Q||"px";J.style.left=a6+Q;J.style.top=a5+Q},w=function(J){return aM(J)[0]},aj=function(J,a5,Q){(aC(J)).style.left=a5+(Q||"px")},t=function(J){return aM(J)[1]},ai=function(J,a5,Q){(aC(J)).style.top=a5+(Q||"px")},s=function(){if(!aA(aR.hasAttribute)&&aB){return function(Q,J){switch(J){case"class":return Q.className||null;case"href":case"src":return Q.getAttribute(J,2)||null;case"style":return Q.getAttribute(J).cssText.toLowerCase()||null;case"for":return Q.attributes[J].nodeValue||null}return Q.getAttribute(J)||null}}return function(Q,J){return Q.getAttribute(J)}}(),aG=function(J,a5){var Q,a5=g(a5);if(a5==="opacity"){if(!aA(J.__opacity)){J.__opacity=1}return J.__opacity}if(J.style[a5]){return J.style[a5]}else{if("getComputedStyle"in ay){return ay.getComputedStyle(J,null)[a5]}else{if("currentStyle"in J){return J.currentStyle[a5]}}}},E=function(a5,Q,J){var a7=function(a9,a8){if(a9==="float"){a9="cssFloat"}if(a9==="opacity"){B(a5,a8)}else{a5.style[g(a9)]=a8}},a6;if(H(Q)){for(a6 in Q){a7(a6,Q[a6])}}else{if(J){a7(Q,J)}}},B=function(){if("filters"in aR){return function(J,Q){if(J.__opacity===undefined){J.__opacity=1}J.style.filter=Q===1?"":"alpha(opacity="+(Q*100)+")";J.__opacity=Q}}return function(J,Q){if(J.__opacity===undefined){J.__opacity=1}J.style.opacity=J.__opacity=Q}}(),P=function(a5,Q,a6){var J=aP,a7=J.ns;if(!(a5=aC(a5))){return}if(!(a7 in a5)){a5[a7]=ag();J[a5[a7]]={}}J[a5[a7]][Q]=a6},ax=function(a5,Q){var J=aP,a6=J.ns;if(!(a5=aC(a5))){return}if(a6 in a5&&a5[a6]in J){return J[a5[a6]][Q]}return null},V=function(a5,Q){var J=aP,a6=J.ns;if(!(a5=aC(a5))){return}if(a6 in a5&&a5[a6]in J){delete J[a5[a6]][Q]}},aP={ns:"jelly_"+(+new Date)},ag=function(){var J=0;return function(){return++J}}();av(au,{addClass:aX,removeClass:aZ,hasClass:a4,toggleClass:z,getElements:R,getElement:aC,createElement:ao,createBranch:a2,wrapElement:aD,withElement:l,replaceElement:ak,removeElement:y,insertElement:aV,insertTop:j,insertBefore:an,insertAfter:C,getFirst:aT,getLast:v,getNext:M,getPrevious:at,getChildren:D,getXY:aM,setXY:am,getX:w,setX:aj,getY:t,setY:ai,getAttribute:s,getStyle:aG,setStyle:E,setOpacity:B,storeData:P,retrieveData:ax,removeData:V});var Z=function(a8,a5,Q){a8=aC(a8);var J=a5==="mouseenter",a6=a5==="mouseleave",a9,a7;if(a8===K&&a5==="domready"){return q(Q)}if(!N){a9=function(ba){Q.call(a8,e(ba))}}if(J||a6){a9=function(ba){ba=e(ba);if(!G.call(a8,ba)){return}Q.call(a8,ba)};a5=J?"mouseover":"mouseout"}a7=[a8,a5,a9||Q];m.push(a7);if(N){a8.addEventListener(a5,a9||Q,false)}else{a8.attachEvent("on"+a5,a9)}return a7},ac=function(J){if(J){if(!a(J)){return X(J)}if(N){J[0].removeEventListener(J[1],J[2],false)}else{J[0].detachEvent("on"+J[1],J[2])}}},m=[],L=function(){for(var J=0,Q;m[J];J++){Q=m[J];if(Q[0]!==ay&&Q[1]!=="unload"){ac(Q)}}},e=function(){if(N){return function(J){return J}}return function(J){J=ay.event;J.target=J.srcElement;J.relatedTarget=function(){switch(J.type){case"mouseover":return J.fromElement;case"mouseout":return J.toElement}}();J.stopPropagation=function(){J.cancelBubble=true};J.preventDefault=function(){J.returnValue=false};J.pageX=J.clientX+aR.scrollLeft;J.pageY=J.clientY+aR.scrollTop;return J}}(),G=function(a7){var a6,a5;if(a7.relatedTarget){try{a6=a7.relatedTarget;if(a6.nodeType!==1||a6===this){return false}var Q=this.getElementsByTagName("*"),a8=Q.length,a5=0;for(a5;a8>a5;a5++){if(a6===Q[a5]){return false}}}catch(J){}}return true},n=function(J){J=e(J);J.stopPropagation();J.preventDefault();return J};av(au,{addEvent:Z,removeEvent:ac,stopEvent:n,fixEvent:e});Z(ay,"unload",L);(function(){var Q=au.DomReady={ready:false,handlers:{},add:function(a9,a8){var a8=a8||++a5;Q.handlers[a8]=a9;return a8},remove:function(a8){delete Q.handlers[a8]},fire:function(){if(Q.ready){return}Q.ready=true;clearTimeout(a6);for(var a9 in Q.handlers){try{Q.handlers[a9]()}catch(a8){ab(a8)}}}},a5=0,a6,a7=function(){if(K.readyState==="complete"){K.detachEvent("onreadystatechange",a7);Q.fire()}},J=function(){try{aR.doScroll("left")}catch(a8){a6=setTimeout(J,10);return}Q.fire()};if(N){Z(K,"DOMContentLoaded",Q.fire)}else{K.attachEvent("onreadystatechange",a7);if(ay===top){a6=setTimeout(J,0)}}Z(ay,"load",Q.fire)})();var r=au.DomReady,q=function(Q,J){return r.add(Q,J||null)},X=function(J){r.remove(J)};av(au,{addDomReady:q,removeDomReady:X});av(au,{getCookie:function(Q){var J=new RegExp(Q+"=([^; ]+)").exec(K.cookie);return J?unescape(J[1]):null},setCookie:function(Q,a7,J,a9,a6,a8){if(J){var a5=(+new Date)+((1000*60*60*24)*J);J=new Date(a5).toUTCString()}K.cookie=Q+"="+escape(a7)+(J?";expires="+J:"")+(a9?";path="+a9:"")+(a6?";domain="+a6:"")+(a8?";secure":"")},removeCookie:function(J,a5,Q){if(au.getCookie(J)){K.cookie=J+"="+(a5?";path="+a5:"")+(Q?";domain="+Q:"")+(";expires="+new Date(0))}}});av(au,{getFlashVersion:function(){var J={major:0,build:0},a5=navigator.plugins,a8,Q;if(a5&&H(a5["Shockwave Flash"])){a8=a5["Shockwave Flash"].description;if(a8!==null){Q=a8.replace(/^[^\d]+/,"");version.major=parseInt(Q.replace(/^(.*)\..*$/,"$1"),10);version.build=parseInt(Q.replace(/^.*r(.*)$/,"$1"),10)}}else{if(aB){try{var a7=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");a8=a7.GetVariable("$version");if(a8!==null){Q=a8.replace(/^\S+\s+(.*)$/,"$1").split(",");version.major=parseInt(Q[0],10);version.build=parseInt(Q[2],10)}}catch(a6){}}}return version},createFlashObject:function(a7,a5,J,a9,a8,a6,Q){var a8=a8||{};a6=a6||{},attrs=Q||{},a9=a9||'You need <a href="http://www.adobe.com/go/getflashplayer">Adobe Flash Player</a> installed to view this content</a>',data=[],ar,output="<object";if(aB){attrs.classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000";a8.movie=a7}else{attrs.data=a7;attrs.type="application/x-shockwave-flash"}attrs.width=a5;attrs.height=J;for(ar in attrs){output+=" "+i+'="'+attr[i]+'"'}output+=">\n";for(ar in a6){data.push(ar+"="+encodeURIComponent(a6[ar]))}if(data.length>0){a8.flashvars=data.join("&")}for(ar in a8){output+='\t<param name="'+ar+'" value="'+a8[ar]+'" />\n'}return output+a9+"\n</object>"},embedFlashObject:function(a6,a8,a5,J,a9,a7,Q){a6=aC(a6);a6.innerHTML=au.createFlashObject(a8,a5,J,a6.innerHTML,a9||{},a7||{},Q||{})}});var ae=function(){if(aA(aR.clientWidth)&&aR.clientWidth!==0){return function(){return[aR.clientWidth,aR.clientHeight]}}return function(){return[K.body.clientWidth||0,K.body.clientHeight||0]}}(),A=function(){if(aA(ay.pageYOffset)){return function(){return[ay.pageXOffset,ay.pageYOffset]}}return function(){if(aA(aR.scrollTop)&&(aR.scrollTop>0||aR.scrollLeft>0)){return[aR.scrollLeft,aR.scrollTop]}return[K.body.scrollLeft,K.body.scrollTop]}}(),aw=function(a5){a5=a5||ay.location;var a6={};if(/\?/.test(a5.href)){var J=a5.href.split("?")[1].split("&"),Q=J.length-1,a7;do{a7=J[Q].split("=");a6[a7[0]]=decodeURIComponent(a7[1].replace(/\+/g,"%20"))}while(Q--)}return a6},af=function(){var J=function(a5,a6){if(!a5){return}if(callbackFilter){a6=callbackFilter.call(a6,a6)}data.push(a5+"="+encodeURIComponent(a6).replace(/%20/g,"+"))},Q=function(a7){if(!az(a7)||!/^(input|textarea|select)$/i.test(a7.nodeName)){return}var a6=a7.type.toLowerCase(),a5=a7.name,a8=a7.value;switch(a6){case"checkbox":if(a7.checked){J(a5,a8||"on")}break;case"radio":if(a7.checked){J(a5,a8)}break;default:J(a5,a8)}};args=O(arguments),callbackFilter=aL(args[args.length-1])?args.pop():null;data=[];args.each(function(a5){if(H(a5)&&ap(a5.length)){(a(a5)?a5:O(a5)).each(Q)}else{if(H(a5,true)){for(var a6 in a5){J(a6,a5[a6])}}else{if(aY(a5)||az(a5)){var a7=aC(a5);if(a7){Q(a7);au.Q(a7,"textarea, input, select").each(Q)}else{data.push(a5)}}}}});return data.join("&")},aJ=function(){var J=["var J=JELLY"],a5,Q=1;for(a5 in au){J[Q++]=a5+"=J."+a5}return J.join(",")+";"};av(au,{getViewport:ae,getWindowScroll:A,parseQuery:aw,buildQuery:af,unpack:aJ});if(aK.ie6){try{K.execCommand("BackgroundImageCache",false,true)}catch(a3){}}var T=["unknown"],ar;for(ar in aK){if(aK[ar]){if(T[0]==="unknown"){T=[ar]}else{T.push(ar)}}}aX(aR,"js "+T.join(" "));(function(){var bw=function(bB){bf[bf.length]=bB},bA=function(bC){for(var bB=0,bD=bC.length;bB<bD;bB++){bC[bB][bg]=null}},bc=function(bC){var bB,bE=bC.length,bD=[];while(bE){bB=bC[--bE];if(!bB[bg]){bB[bg]=true;bD[bD.length]=bB}}bE=bD.length;while(bE){bD[--bE][bg]=null}return bD.reverse()},bb=function(bC,bB){var bE={mode:bB?bq:be,not:false,type:a8};if(/^(\w+)?#\w/.test(bC)){bE.val=bC.split("#")}else{if(/^\w+|\*$/.test(bC)){bE.type=bp;bE.val=bC}else{if(/^\.\w/.test(bC)){bE.type=bd;bE.val=bC.replace(/^\./,"")}else{if(/^\[/.test(bC)){bE.type=br;bE.val=bC.replace(/\[|\]/g,"")}else{if(/^\+|>|~/.test(bC)){bE.type=a6;bE.val=bC}else{if(/:not\(/.test(bC)){bE=bb(bC.replace(/\:not\(|\)$/g,""));bE.not=true}else{if(/^:/.test(bC)){var bD=bC.replace(/^:|\)$/g,"").split("(");bE.type=a7;bE.kind=bD[0];bE.val=bD[1]}}}}}}}return bE},bv=function(bC){var bK=[],bE=aS(bC.replace(/(>|~(?!=)|\+(?!\d))/g," $1 ")).split(" "),bJ={mode:bq,type:bp,val:"*"},bB="getElementsByClassName"in K,bI=false;for(var bG=0,bH;bG<bE.length;bG++){bH=bE[bG].replace(/([^\(\#\.\[])(:)/g,"$1 $2").replace(/([^\(])(\[|\.)/g,"$1 $2").replace(/\:not\(\s*/g,":not(").trim().split(" ");for(var bD=0,bF;bD<bH.length;bD++){bF=bb(bH[bD],!bD);if(bI){bF.mode=be}else{if(bD===0&&(bF.type===a7||bF.type===br||(bF.type===bd&&!bB)||bF.not)){bK.push(bJ);bF.mode=be}}if(aa(bH[bD],bg)){bF[bF.type===br?"spValue":"val"]=a9.shift()}bK.push(bF);bI=/^(~|\+)$/.test(bF.val)}}bK.postFilter=!(bE.length===1||bE.length===3&&/^[\+~]$/.test(bE[1]));return bK},Q=function(bD){var bB=bD.val[0],bH=bD.val[1];if(bD.mode===be){for(var bE=0,bG=bo.length;bE<bG;bE++){if(bB){if((bo[bE].tagName.toLowerCase()===bB&&bo[bE].id===bH)!==bD.not){bw(bo[bE])}}else{if((bo[bE].id===bH)!==bD.not){bw(bo[bE])}}if(!bD.not&&bf[0]){return}}}else{if(!bB){bf[0]=aC(bH)}else{var bF=aC(bH);if(bF&&bF.tagName.toLowerCase()===bB){bf[0]=bF}}if(!ba&&bf[0]){var bC=false;for(var bE=0,bG=bo.length;bE<bG;bE++){if(bf[0].contains(bo[bE])){bC=true;break}}if(!bC){bf[0]=null}}}},bs=function(bC){var bB=aB&&bC.val==="*";if(ba){for(var bG=0,bE=R(bC.val),bI=bE.length;bG<bI;bG++){if(bB){if(bE[bG].nodeType===1){bw(bE[bG])}}else{bw(bE[bG])}}}else{if(bC.not||bC.mode===be){for(var bG=0,bH=bC.val.toUpperCase(),bI=bo.length;bG<bI;bG++){if((bo[bG].nodeName.toUpperCase()===bH)!==bC.not){bw(bo[bG])}}}else{for(var bG=0,bI=bo.length;bG<bI;bG++){var bE=R(bo[bG],bC.val),bF=bE.length,bD=0;for(bD;bD<bF;bD++){if(bB){if(bE[bD].nodeType===1){bw(bE[bD])}}else{bw(bE[bD])}}}}}},J=function(bD){var bC=bD.val,bE=bD.not,bB=bo.length,bH=0;if(bD.mode===bq){if(ba){bf=O(K.getElementsByClassName(bC))}else{for(bH;bH<bB;bH++){var bK=bo[bH].getElementsByClassName(bC),bJ=bK.length,bG=0;for(bG;bG<bJ;bG++){bw(bK[bG])}}}}else{var bI=new RegExp("(^|\\s)"+bC+"(\\s|$)"),bF;for(bH;bH<bB;bH++){bF=bo[bH].className;if(!bF){if(bE){bw(bo[bH])}continue}if(bI.test(bF)!==bE){bw(bo[bH])}}}},by={"=":function(bB,bC){return bB===bC},"^=":function(bB,bC){return bB.indexOf(bC)===0},"$=":function(bB,bC){return bB.substr(bB.length-bC.length)===bC},"*=":function(bB,bC){return bB.indexOf(bC)!==-1},"|=":function(bB,bC){return bB.indexOf(bC)===0},"~=":function(bB,bC){return(" "+bB+" ").indexOf(" "+bC+" ")!==-1}},bl=function(bC){var bG=bo.length,bD=0;if(aa(bC.val,"=")){var bE=/([\w-]+)([^=]?=)(.+)/.exec(bC.val),bB,bF=aA(bC.spValue)?bC.spValue:bE[3];for(bD;bD<bG;bD++){bB=s(bo[bD],bE[1]);if((bB!==null&&by[bE[2]](bB,bF))!==bC.not){bw(bo[bD])}}}else{for(bD;bD<bG;bD++){if((s(bo[bD],bC.val)!==null)!==bC.not){bw(bo[bD])}}}},bm=function(bB){var bD=bB.kind,bE=bB.not;if(/^(nth-|first-of|last-of)/.test(bD)){bf=bt[bD](bo,bB)}else{if(bD==="root"&&!bE){bf[0]=rootElement}else{if(bD==="target"&&!bE){var bF=ay.location.href.split("#")[1]||null;bf[0]=aC(bF)||R(bF)[0]}else{for(var bC=0,bG=bo.length;bC<bG;bC++){if(bt[bD](bo[bC],bB)!==bE){bw(bo[bC])}}}}}},bn=function(bC){var bB={mode:"all"};bB.direction=bC.indexOf("-")===0?"neg":"pos";if(bC==="n"){return bB}else{if(/^\d+$/.test(bC)){bB.mode="child";bB.val=parseInt(bC,10);return bB}}bB.mode="an+b";if(/^(even|2n|2n\+2)$/.test(bC)){bB.oddEven=0}else{if(/^(odd|2n\+1)$/.test(bC)){bB.oddEven=1}}var bD=bC.split("n");bB.start=bD[1]?parseInt(bD[1],10):1;bB.jump=bD[0]&&bD[0]!=="-"?parseInt(bD[0].replace(/^\-/,""),10):1;return bB},bx=function(bJ,bN,bG,bP,bH){bN=bn(bN);if(bN.mode==="all"){return bJ}var bQ=[],bO=[],bM=bJ[0].nodeName,bF=bG?function(bR){return bR.nodeType===1&&bR.nodeName===bM}:function(bR){return bR.nodeType===1},bD=function(bR){if(bR){bQ.push(bJ[bI])}};for(var bI=0,bE=bJ.length,bB,bK;bI<bE;bI++){bB=bJ[bI].parentNode,bK=1;if(!bB[bg]){var bC=bB[!bP?"firstChild":"lastChild"],bL=!bP?"nextSibling":"previousSibling";for(bC;bC;bC=bC[bL]){if(bF(bC)){bC.nodeIndex=bK++}}bB[bg]=1;bO.push(bB)}if(bN.mode==="child"){bD(((bJ[bI].nodeIndex===bN.val)!==bH))}else{if(aA(bN.oddEven)){bD((bJ[bI].nodeIndex%2===bN.oddEven)!==bH)}else{if(bN.direction==="pos"){if(bJ[bI].nodeIndex<bN.start){if(bH){bD(true)}}else{bD(((bJ[bI].nodeIndex-bN.start)%bN.jump===0)!==bH)}}else{if(bJ[bI].nodeIndex>bN.start){if(bH){bD(true)}}else{bD(((bN.start-bJ[bI].nodeIndex)%bN.jump===0)!==bH)}}}}}bA(bO);return bN.direction==="neg"?bQ.reverse():bQ},bt={"nth-child":function(bC,bB){return bx(bC,bB.val,false,false,bB.not)},"nth-of-type":function(bC,bB){return bx(bC,bB.val,true,false,bB.not)},"nth-last-child":function(bC,bB){return bx(bC,bB.val,false,true,bB.not)},"nth-last-of-type":function(bC,bB){return bx(bC,bB.val,true,true,bB.not)},"first-of-type":function(bC,bB){return bx(bC,"1",true,false,bB.not)},"last-of-type":function(bC,bB){return bx(bC,"1",true,true,bB.not)},"only-child":function(bB){return!M(bB)&&!at(bB)},"only-of-type":function(bE){var bC=R(bE.parentNode,bE.nodeName);if(bC.length===1&&bC[0].parentNode===bE.parentNode){return true}else{for(var bB=true,bG=bC.length,bD=0,bF=0;bD<bG;bD++){if(bE.parentNode===bC[bD].parentNode){bF++;if(bF>1){return false}}}return true}},"first-child":function(bB){return!at(bB)},"last-child":function(bB){return!M(bB)},checked:function(bB){return bB.checked},enabled:function(bB){return!bB.disabled},disabled:function(bB){return bB.disabled},empty:function(bB){return!bB.firstChild},lang:function(bC,bB){return bC.getAttribute("lang")===bB.val},root:function(bB){return bB===rootElement},target:function(bB){var bC=ay.location.href.split("#")[1]||null;return bB.id===bC||bB.name===bC}},bj=function(){for(var bB=0,bD=bo.length,bC;bB<bD;bB++){if(bC=M(bo[bB])){bw(bC)}}},bi=function(){var bB=[],bG=[],bF=bo.length,bC=0,bD,bE;for(bC;bC<bF;bC++){bE=bo[bC].parentNode;bE[bg]=true;bB.push({parent:bE,child:bo[bC]})}for(bC=0;bC<bB.length;bC++){if(bB[bC].parent[bg]){bB[bC].parent[bg]=null;bG.push(bB[bC].child)}}for(bC=0;bC<bG.length;bC++){bD=bG[bC].nextSibling;while(bD){if(bD.nodeType===1){bw(bD)}bD=bD.nextSibling}}},bk=function(){var bC=[],bF=bo.length,bG=bf.length,bB,bE=0,bD;for(bE;bE<bG;bE++){bB=bf[bE].parentNode;for(bD=0;bD<bF;bD++){if(bo[bD]===bB){bC.push(bf[bE]);break}}}bf=bC},ba=1,a9=[],bg="__JELLY_Q__",bf=[],bo=[],be=1,bq=2,a8=3,bp=4,bd=5,br=6,a7=7,a6=8,bh=function(bN,bM){var bL=!!bM,bH=bL?bM:bN;bo=bL?[bN]:[];if(ba){var bF;while(bF=/('|")([^\1]*?)\1/.exec(bH)){a9.push(bF[2]);bH=bH.split(bF[0]);bH=[bH[0],bg,bH[1]].join("")}}if(aa(bH,",")){var bE=[],bI=bH.split(","),bC;ba=0;while(bC=bI.shift()){bE=bE.concat(bL?bh(bN,bC):bh(bC))}ba=1;return bc(bE)}ba=!bM;var bK=bv(bH),bB=null;for(var bJ=0,bD=bK.length,bG;bJ<bD;bJ++){bf=[];bG=bK[bJ];switch(bG.type){case a8:Q(bG);break;case bp:bs(bG);break;case bd:J(bG);break;case br:bl(bG);break;case a7:bm(bG);break;case a6:if(bG.val==="+"){bj(bG)}else{if(bG.val==="~"){bi(bG)}}}if(bB){bk()}if(bG.val===">"){bB=true;continue}if(!bf[0]){return[]}bB=null;ba=0;bo=bf}if(bK.postFilter){return bz(bc(bo))}return bz(bo)},a5=function(bC,bB){try{return bz(O(bB?bC.querySelectorAll(bB):K.querySelectorAll(bC)))}catch(bD){aH(bD)}},bz=function(bC){for(var bB in bu){bC[bB]=bu[bB]}return bC},bu={};["addClass","removeClass","setStyle","addEvent"].each(function(bB){bu[bB]=function(){var bC=O(arguments),bE=this.length,bD=0;for(bD;bD<bE;bD++){au[bB].apply({},[this[bD]].concat(bC))}return this}});au.Q=function(){if(S){if(!aK.ie){return a5}return function(bC,bB){if(/\:(nth|las|onl|not|tar|roo|emp|ena|dis|che)/.test(bB||bC)){return bh(bC,bB)}return a5(bC,bB)}}return bh}()})();var al=au.Q;(function(){var J=aE("Request",{__init:function(Q){av(this,Q)},__static:{timeout:15000},noCache:true,async:true,cleanUp:true,feedback:{start:W,stop:W},requestHeaders:{},send:function(Q,a6,ba){var bc=this,a5=a6,a7=null,Q=Q.toUpperCase(),bb=bc.xhr?bc.xhr:bc.getXHR();if(bc.inProgress||!bb){return false}if(Q==="POST"){var a8=a6.split("?");a5=a8[0];a7=a8[1];bc.requestHeaders["Content-Type"]="application/x-www-form-urlencoded; charset=UTF-8";bc.requestHeaders["Content-length"]=a7.length}if(Q==="GET"&&bc.noCache){bc.requestHeaders["If-Modifed-Since"]="Sat, 1 Jan 2000 00:00:00 GMT"}bb.open(Q,a5,bc.async);bb.onreadystatechange=function(){if(bb.readyState===4){bc.fireEvent("complete",bb);clearTimeout(bc.timer);bc.feedback.stop();var bd=bb.status,be=(bd>=200&&bd<300)||bd===304||(bd===undefined&&aK.webkit);if(be){bc.fireEvent("success",bb);if(ba){ba.call(bc,bb)}}else{bc.fireEvent("fail",bb)}if(bc.cleanUp){bc.xhr=null}bc.inProgress=false}};for(var a9 in bc.requestHeaders){bb.setRequestHeader(a9,bc.requestHeaders[a9])}bb.setRequestHeader("X-Requested-With","XMLHttpRequest");bc.feedback.start();bc.timer=setTimeout(function(){bb.abort();bc.fireEvent("timeout",bb);bc.inProgress=false},bc.timeout||J.timeout);bc.inProgress=true;bb.send(a7);bc.fireEvent("request",bb);return true},post:function(Q,a5,a6){return this.send("post",Q+"?"+(a5||"empty"),a6)},get:function(Q,a5){return this.send("get",Q,a5)},getXHR:function(){if("XMLHttpRequest"in ay){return function(){return new XMLHttpRequest()}}return function(){var a5=false;try{a5=new ActiveXObject("Msxml2.XMLHTTP")}catch(Q){try{a5=new ActiveXObject("Microsoft.XMLHTTP")}catch(Q){}}return a5}}()})})();au.easings={linear:function(a6,J,Q,a5){return Q*a6/a5+J},quadIn:function(a6,J,Q,a5){return Q*(a6/=a5)*a6+J},quadOut:function(a6,J,Q,a5){return-Q*(a6/=a5)*(a6-2)+J},quadInOut:function(a6,J,Q,a5){if((a6/=a5/2)<1){return Q/2*a6*a6+J}return-Q/2*((--a6)*(a6-2)-1)+J},cubicIn:function(a6,J,Q,a5){return Q*(a6/=a5)*a6*a6+J},cubicOut:function(a6,J,Q,a5){return Q*((a6=a6/a5-1)*a6*a6+1)+J},cubicInOut:function(a6,J,Q,a5){if((a6/=a5/2)<1){return Q/2*a6*a6*a6+J}return Q/2*((a6-=2)*a6*a6+2)+J},quartIn:function(a6,J,Q,a5){return Q*(a6/=a5)*a6*a6*a6+J},quartOut:function(a6,J,Q,a5){return-Q*((a6=a6/a5-1)*a6*a6*a6-1)+J},quartInOut:function(a6,J,Q,a5){if((a6/=a5/2)<1){return Q/2*a6*a6*a6*a6+J}return-Q/2*((a6-=2)*a6*a6*a6-2)+J},quintIn:function(a6,J,Q,a5){return Q*(a6/=a5)*a6*a6*a6*a6+J},quintOut:function(a6,J,Q,a5){return Q*((a6=a6/a5-1)*a6*a6*a6*a6+1)+J},quintInOut:function(a6,J,Q,a5){if((a6/=a5/2)<1){return Q/2*a6*a6*a6*a6*a6+J}return Q/2*((a6-=2)*a6*a6*a6*a6+2)+J},sineIn:function(a6,J,Q,a5){return-Q*Math.cos(a6/a5*(Math.PI/2))+Q+J},sineOut:function(a6,J,Q,a5){return Q*Math.sin(a6/a5*(Math.PI/2))+J},sineInOut:function(a6,J,Q,a5){return-Q/2*(Math.cos(Math.PI*a6/a5)-1)+J},expoIn:function(a6,J,Q,a5){return(a6==0)?J:Q*Math.pow(2,10*(a6/a5-1))+J},expoOut:function(a6,J,Q,a5){return(a6==a5)?J+Q:Q*(-Math.pow(2,-10*a6/a5)+1)+J},expoInOut:function(a6,J,Q,a5){if(a6==0){return J}if(a6==a5){return J+Q}if((a6/=a5/2)<1){return Q/2*Math.pow(2,10*(a6-1))+J}return Q/2*(-Math.pow(2,-10*--a6)+2)+J},circIn:function(a6,J,Q,a5){return-Q*(Math.sqrt(1-(a6/=a5)*a6)-1)+J},circOut:function(a6,J,Q,a5){return Q*Math.sqrt(1-(a6=a6/a5-1)*a6)+J},circInOut:function(a6,J,Q,a5){if((a6/=a5/2)<1){return-Q/2*(Math.sqrt(1-a6*a6)-1)+J}return Q/2*(Math.sqrt(1-(a6-=2)*a6)+1)+J},elasticIn:function(a8,J,Q,a5,a9,a6){if(a8==0){return J}if((a8/=a5)==1){return J+Q}if(!a6){a6=a5*0.3}if(!a9){a9=1}if(a9<Math.abs(Q)){a9=Q;var a7=a6/4}else{var a7=a6/(2*Math.PI)*Math.asin(Q/a9)}return-(a9*Math.pow(2,10*(a8-=1))*Math.sin((a8*a5-a7)*(2*Math.PI)/a6))+J},elasticOut:function(a8,J,Q,a5,a9,a6){if(a8==0){return J}if((a8/=a5)==1){return J+Q}if(!a6){a6=a5*0.3}if(!a9){a9=1}if(a9<Math.abs(Q)){a9=Q;var a7=a6/4}else{var a7=a6/(2*Math.PI)*Math.asin(Q/a9)}return a9*Math.pow(2,-10*a8)*Math.sin((a8*a5-a7)*(2*Math.PI)/a6)+Q+J},elasticInOut:function(a8,J,Q,a5,a9,a6){if(a8==0){return J}if((a8/=a5/2)==2){return J+Q}if(!a6){a6=a5*(0.3*1.5)}if(!a9){a9=1}if(a9<Math.abs(Q)){a9=Q;var a7=a6/4}else{var a7=a6/(2*Math.PI)*Math.asin(Q/a9)}if(a8<1){return-0.5*(a9*Math.pow(2,10*(a8-=1))*Math.sin((a8*a5-a7)*(2*Math.PI)/a6))+J}return a9*Math.pow(2,-10*(a8-=1))*Math.sin((a8*a5-a7)*(2*Math.PI)/a6)*0.5+Q+J},backOffset:1.70158,backIn:function(a7,J,Q,a5,a6){if(!a6){a6=au.easings.backOffset}return Q*(a7/=a5)*a7*((a6+1)*a7-a6)+J},backOut:function(a7,J,Q,a5,a6){if(!a6){a6=au.easings.backOffset}return Q*((a7=a7/a5-1)*a7*((a6+1)*a7+a6)+1)+J},backInOut:function(a7,J,Q,a5,a6){if(!a6){a6=au.easings.backOffset}if((a7/=a5/2)<1){return Q/2*(a7*a7*(((a6*=(1.525))+1)*a7-a6))+J}return Q/2*((a7-=2)*a7*(((a6*=(1.525))+1)*a7+a6)+2)+J},bounceIn:function(a6,J,Q,a5){return Q-au.easings.bounceOut(a5-a6,0,Q,a5)+J},bounceOut:function(a6,J,Q,a5){if((a6/=a5)<(1/2.75)){return Q*(7.5625*a6*a6)+J}else{if(a6<(2/2.75)){return Q*(7.5625*(a6-=(1.5/2.75))*a6+0.75)+J}else{if(a6<(2.5/2.75)){return Q*(7.5625*(a6-=(2.25/2.75))*a6+0.9375)+J}else{return Q*(7.5625*(a6-=(2.625/2.75))*a6+0.984375)+J}}}},bounceInOut:function(a6,J,Q,a5){if(a6<a5/2){return au.easings.bounceIn(a6*2,0,Q,a5)*0.5+J}return au.easings.bounceOut(a6*2-a5,0,Q,a5)*0.5+Q*0.5+J}};(function(){var J=aE("Tween",{__init:function(Q,a5){this.el=aC(Q);av(this,a5||{})},__static:{uid:0,tweens:{},timerSpeed:20,subscribe:function(Q){J.tweens[Q.tweenId]=function(){Q.step.call(Q)};if(!J.timerHandle){J.startTimer()}},unSubscribe:function(Q){delete J.tweens[Q.tweenId];clearTimeout(J.timeoutHandle);J.timeoutHandle=setTimeout(function(){if(aN(J.tweens)){J.stopTimer()}},250)},startTimer:function(){var Q=function(){for(var a5 in J.tweens){J.tweens[a5]()}};J.timerHandle=setInterval(Q,J.timerSpeed)},stopTimer:function(){if(J.timerHandle){clearInterval(J.timerHandle)}J.timerHandle=null}},easing:au.easings.sineInOut,duration:500,unit:"px",setEasing:function(Q){this.easing=au.easings[Q];return this},setDuration:function(Q){this.duration=Q;return this},setOpacity:function(Q){B(this.el,Q);return this},setElement:function(Q){this.el=aC(Q);return this},sequence:function(){this.sequenceStack=O(arguments);this.callSequence();return this},callSequence:function(){var Q=this,a5=a(Q.sequenceStack)?Q.sequenceStack.shift():null;if(a5){if(aL(a5)){a5.call(Q,Q)}else{Q.start(a5)}}else{Q.fireEvent("sequenceComplete")}},stop:function(){J.unSubscribe(this);return this},start:function(a9){var bf=this,bc=O(arguments),a7=bf.el;if(aA(bc[1])){a9={};a9[bc[0]]=bc[1]}bf.stop();bf.stack=[];if(a(a7)||a0(a7)){a7=a7[0]}if("duration"in a9){bf.setDuration(a9.duration);delete a9.duration}if("easing"in a9){bf.setEasing(a9.easing);delete a9.easing}var Q,be,bd;for(Q in a9){be=g(Q),bd=a9[Q];if(Q.indexOf("color")!==-1){if(a(bd)){bd=[aU(bd[0],"rgb-array"),aU(bd[1],"rgb-array")]}else{var a5=aG(a7,be);if(isNaN(a5)&&!aY(a5)){return aH('getStyle for "%s" returns NaN',be)}bd=[aU(a5,"rgb-array"),aU(bd,"rgb-array")]}bd.color=true}else{if(Q==="background-position"){if(a(bd[0])){bd=[bd[0][0],bd[0][1]],[bd[1][0],bd[1][1]]}else{var ba=0,a8=0,bb=aG(a7,be),a6=/(\d+)[\w%]{1,2}\s+(\d+)[\w%]{1,2}/.exec(bb);if(bb&&a6){ba=parseInt(a6[1],10);a8=parseInt(a6[2],10)}bd=[[ba,bd[0]],[a8,bd[1]]]}bd.bgp=true}else{if(!a(bd)){var a5=parseInt(aG(a7,be),10);if(isNaN(a5)&&!aY(a5)){return aH('getStyle for "%s" returns NaN',be)}bd=[a5,bd];if(Q==="opacity"){bd.opac=true}}else{bd=bd}}}bf.stack.push({prop:be,from:bd[0],to:bd[1],color:bd.color,bgp:bd.bgp,opac:bd.opac})}bf.startTime=+(new Date);bf.tweenId=++J.uid;J.subscribe(bf);bf.fireEvent("start");return bf},step:function(){var Q=this,a5=+(new Date);if(a5<Q.startTime+Q.duration){Q.elapsedTime=a5-Q.startTime}else{Q.stop();Q.tidyUp();setTimeout(function(){Q.fireEvent("complete");Q.callSequence()},0);return}Q.increase()},tidyUp:function(){var Q=this,a7,a6=Q.el.style,a5=Q.stack.length-1;do{a7=Q.stack[a5];if(a7.opac){Q.setOpacity(a7.to)}else{if(a7.color){a6[a7.prop]="rgb("+a7.to.join(",")+")"}else{if(a7.bgp){a6.backgroundPosition=a7.to[0]+Q.unit+" "+a7.to[1]+Q.unit}else{a6[a7.prop]=a7.to+Q.unit}}}}while(a5--)},increase:function(){var a5=this,ba,Q=Math.round,a8=a5.el.style,a7=a5.stack.length-1,a6=(aK.ie||aK.opera||aK.webkit)&&a5.unit==="px";do{ba=a5.stack[a7];if(ba.opac){a5.setOpacity(a5.compute(ba.from,ba.to))}else{if(ba.color){a8[ba.prop]="rgb("+Q(a5.compute(ba.from[0],ba.to[0]))+","+Q(a5.compute(ba.from[1],ba.to[1]))+","+Q(a5.compute(ba.from[2],ba.to[2]))+")"}else{if(ba.bgp){a8.backgroundPosition=a5.compute(ba.from[0],ba.to[0])+a5.unit+" "+a5.compute(ba.from[1],ba.to[1])+a5.unit}else{var a9=a5.compute(ba.from,ba.to);a8[ba.prop]=(a6?Q(a9):a9)+a5.unit}}}}while(a7--)},compute:function(a5,Q){return this.easing(this.elapsedTime,a5,(Q-a5),this.duration)}})})();var k=au.Tween;(function(){var J=au.Load={cache:{},js:function(ba,bb,a8){if(J.cache[ba]){return J.cache[ba]}var a5=av({type:"text/javascript"},a8||{}),a7=ao("script",a5),a9=function(){J.cache[ba]=a7;if(bb){aq(bb,a7,a7)}},Q=function(bc){ab(bc,': "'+ba+'"')};try{if(a7.readyState){a7.onreadystatechange=function(){if(/^(loaded|complete)$/.test(a7.readyState)){a7.onreadystatechange=null;a9()}}}else{a7.onload=a9;a7.onerror=Q}a7.src=ba;aV(a7,F);return a7}catch(a6){ab(a6)}},css:function(a7,a6){if(J.cache[a7]){return J.cache[a7]}var Q=av({type:"text/css",media:"screen",rel:"stylesheet"},a6||{}),a5=ao("link",Q);a5.href=a7;J.cache[a7]=a5;aV(a5,F);return a5},img:function(a8,a9,a6){if(J.cache[a8]){return J.cache[a8]}var a5=ao("img",a6||{}),a7=function(){J.cache[a8]=a5;if(a9){a9.call(a5,a5)}},Q=function(ba){aH(I(ba.type)+' loading image: "'+a8+'"')};a5.onload=a7;a5.onerror=a5.onabort=Q;a5.src=a8;return a5},purge:function(a5){var Q=J.cache[a5];if(!Q){return}if(aR.contains(Q)){y(Q)}Q.onload=Q.onerror=Q.onabort=null;delete J.cache[a5]}}})();var u=au.Load;(function(){var J=aE("Poll",{__static:{pollTime:300,handlers:{},subscribe:function(a5,a6,a7){var Q=a5+"",a8;if(!(Q in J.handlers)){a8=aY(a5)?J.keywords[a5]:a5;J.handlers[Q]=new ad(a8)}return J.handlers[Q].subscribe(a6,a7||null)},unSubscribe:function(Q,a5){J.handlers[Q].unsubscribe(a5)},keywords:{vslow:1000,slow:500,fast:100,vfast:50}},__init:function(Q){av(this,{handlers:{},pollTime:Q||J.pollTime})},setPollTime:function(Q){this.pollTime=Q;return this},start:function(){var Q=this;clearTimeout(Q.timerHandle);clearTimeout(Q.firstPoll);Q.firstPoll=setTimeout(function(){(function a5(){for(var a7 in Q.handlers){try{Q.handlers[a7]()}catch(a6){ab(a6)}}Q.timerHandle=setTimeout(a5,Q.pollTime)})()},Q.pollTime)},stop:function(){var Q=this;clearTimeout(Q.timerHandle);Q.timerHandle=null;return Q},clear:function(){var Q=this;Q.stop();Q.handlers=null;return Q},subscribe:function(a5,a6){var Q=this,a7;Q.uid=Q.uid||0;a7=a6||++Q.uid;if(Q.handlers[a7]){return false}Q.handlers[a7]=a5;if(!Q.timerHandle){Q.start()}return a7},unSubscribe:function(a5){var Q=this;delete Q.handlers[a5];if(aN(Q.handlers)){Q.stop()}}})})();var ad=au.Poll})();;(function(){eval(JELLY.unpack());addDomReady(function(){var tween=new Tween,onUploadChange=function(e){var status=retrieveData(this,'upload-status');if(this.value){var value='';var files=this.files;for(var i=0;i<files.length-1;i++)
value=value+(browser.ie?files[i].name.split('\\').pop():files[i].name)+', ';i=files.length-1;value=value+(browser.ie?files[i].name.split('\\').pop():files[i].name);status.innerHTML=value;insertAfter(status,this.parentNode);if(e){tween.setElement(status).setOpacity(0).start({opacity:1,duration:500});}}
else if(status&&status.parentNode){removeElement(status);}},onUploadFocus=function(){addClass(this.parentNode,'focus');},onUploadBlur=function(){removeClass(this.parentNode,'focus');};Q('.file-upload input[type=file]').each(function(field){storeData(field,'upload-status',createElement('span.file-upload-status'));addEvent(field,'focus',onUploadFocus);addEvent(field,'blur',onUploadBlur);addEvent(field,'change',onUploadChange);onUploadChange.call(field);if(browser.firefox||browser.opera){field.style.left='-800px';}
else if(browser.ie){field.style.width='0';}});});})();;Calendar=function(firstDayOfWeek,dateStr,onSelected,onClose){Calendar._DN=new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday");Calendar._SDN=new Array("Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun");Calendar._FD=0;Calendar._MN=new Array("January","February","March","April","May","June","July","August","September","October","November","December");Calendar._SMN=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec");Calendar._TT={};Calendar._TT["INFO"]="About the Calendar";Calendar._TT["ABOUT"]="DHTML Date/Time Selector\n"+"(c) dynarch.com 2002-2005 / Author: Mihai Bazon\n"+"For latest version visit: http://www.dynarch.com/projects/calendar/\n"+"Distributed under GNU LGPL.  See http://gnu.org/licenses/lgpl.html for details."+"\n\n"+"Date selection:\n"+"- Use the \xab, \xbb buttons to select year\n"+"- Use the "+String.fromCharCode(0x2039)+", "+String.fromCharCode(0x203a)+" buttons to select month\n"+"- Hold mouse button on any of the above buttons for faster selection.";Calendar._TT["ABOUT_TIME"]="\n\n"+"Time selection:\n"+"- Click on any of the time parts to increase it\n"+"- or Shift-click to decrease it\n"+"- or click and drag for faster selection.";Calendar._TT["PREV_YEAR"]="Click to move to the previous year. Click and hold for a list of years.";Calendar._TT["PREV_MONTH"]="Click to move to the previous month. Click and hold for a list of the months.";Calendar._TT["GO_TODAY"]="Go to today";Calendar._TT["NEXT_MONTH"]="Click to move to the next month. Click and hold for a list of the months.";Calendar._TT["NEXT_YEAR"]="Click to move to the next year. Click and hold for a list of years.";Calendar._TT["SEL_DATE"]="Select a date.";Calendar._TT["DRAG_TO_MOVE"]="Drag to move";Calendar._TT["PART_TODAY"]=" (Today)";Calendar._TT["DAY_FIRST"]="Display %s first";Calendar._TT["WEEKEND"]="0,6";Calendar._TT["CLOSE"]="Close";Calendar._TT["TODAY"]="Today";Calendar._TT["TIME_PART"]="(Shift-)Click or Drag to change the value.";Calendar._TT["DEF_DATE_FORMAT"]="%Y-%m-%d";Calendar._TT["TT_DATE_FORMAT"]="%A, %B %e";Calendar._TT["WK"]="wk";Calendar._TT["TIME"]="Time:";this.activeDiv=null;this.currentDateEl=null;this.getDateStatus=null;this.getDateToolTip=null;this.getDateText=null;this.timeout=null;this.onSelected=onSelected||null;this.onClose=onClose||null;this.dragging=false;this.hidden=false;this.minYear=1970;this.maxYear=2050;this.dateFormat=Calendar._TT["DEF_DATE_FORMAT"];this.ttDateFormat=Calendar._TT["TT_DATE_FORMAT"];this.isPopup=true;this.weekNumbers=true;this.firstDayOfWeek=typeof firstDayOfWeek=="number"?firstDayOfWeek:Calendar._FD;this.showsOtherMonths=false;this.dateStr=dateStr;this.ar_days=null;this.showsTime=false;this.time24=true;this.yearStep=2;this.hiliteToday=true;this.multiple=null;this.table=null;this.element=null;this.tbody=null;this.firstdayname=null;this.monthsCombo=null;this.yearsCombo=null;this.hilitedMonth=null;this.activeMonth=null;this.hilitedYear=null;this.activeYear=null;this.dateClicked=false;if(typeof Calendar._SDN=="undefined"){if(typeof Calendar._SDN_len=="undefined")Calendar._SDN_len=3;var ar=new Array();for(var i=8;i>0;){ar[--i]=Calendar._DN[i].substr(0,Calendar._SDN_len);}Calendar._SDN=ar;if(typeof Calendar._SMN_len=="undefined")Calendar._SMN_len=3;ar=new Array();for(var i=12;i>0;){ar[--i]=Calendar._MN[i].substr(0,Calendar._SMN_len);}Calendar._SMN=ar;}};Calendar._C=null;Calendar.is_ie=(/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent));Calendar.is_ie5=(Calendar.is_ie&&/msie 5\.0/i.test(navigator.userAgent));Calendar.is_opera=/opera/i.test(navigator.userAgent);Calendar.is_khtml=/Konqueror|Safari|KHTML/i.test(navigator.userAgent);Calendar.getAbsolutePos=function(el){var SL=0,ST=0;var is_div=/^div$/i.test(el.tagName);if(is_div&&el.scrollLeft)SL=el.scrollLeft;if(is_div&&el.scrollTop)ST=el.scrollTop;var r={x:el.offsetLeft-SL,y:el.offsetTop-ST};if(el.offsetParent){var tmp=this.getAbsolutePos(el.offsetParent);r.x+=tmp.x;r.y+=tmp.y;}return r;};Calendar.isRelated=function(el,evt){var related=evt.relatedTarget;if(!related){var type=evt.type;if(type=="mouseover"){related=evt.fromElement;}else if(type=="mouseout"){related=evt.toElement;}}while(related){if(related==el){return true;}related=related.parentNode;}return false;};Calendar.removeClass=function(el,className){if(!(el&&el.className)){return;}var cls=el.className.split(" ");var ar=new Array();for(var i=cls.length;i>0;){if(cls[--i]!=className){ar[ar.length]=cls[i];}}el.className=ar.join(" ");};Calendar.addClass=function(el,className){Calendar.removeClass(el,className);el.className+=" "+className;};Calendar.getElement=function(ev){var f=Calendar.is_ie?window.event.srcElement:ev.currentTarget;while(f.nodeType!=1||/^div$/i.test(f.tagName))f=f.parentNode;return f;};Calendar.getTargetElement=function(ev){var f=Calendar.is_ie?window.event.srcElement:ev.target;while(f.nodeType!=1)f=f.parentNode;return f;};Calendar.stopEvent=function(ev){ev||(ev=window.event);if(Calendar.is_ie){ev.cancelBubble=true;ev.returnValue=false;}else{ev.preventDefault();ev.stopPropagation();}return false;};Calendar.addEvent=function(el,evname,func){if(el.attachEvent){el.attachEvent("on"+evname,func);}else if(el.addEventListener){el.addEventListener(evname,func,true);}else{el["on"+evname]=func;}};Calendar.removeEvent=function(el,evname,func){if(el.detachEvent){el.detachEvent("on"+evname,func);}else if(el.removeEventListener){el.removeEventListener(evname,func,true);}else{el["on"+evname]=null;}};Calendar.createElement=function(type,parent){var el=null;if(document.createElementNS){el=document.createElementNS("http://www.w3.org/1999/xhtml",type);}else{el=document.createElement(type);}if(typeof parent!="undefined"){parent.appendChild(el);}return el;};Calendar._add_evs=function(el){with(Calendar){addEvent(el,"mouseover",dayMouseOver);addEvent(el,"mousedown",dayMouseDown);addEvent(el,"mouseout",dayMouseOut);if(is_ie){addEvent(el,"dblclick",dayMouseDblClick);el.setAttribute("unselectable",true);}}};Calendar.findMonth=function(el){if(typeof el.month!="undefined"){return el;}else if(typeof el.parentNode.month!="undefined"){return el.parentNode;}return null;};Calendar.findYear=function(el){if(typeof el.year!="undefined"){return el;}else if(typeof el.parentNode.year!="undefined"){return el.parentNode;}return null;};Calendar.showMonthsCombo=function(){var cal=Calendar._C;if(!cal){return false;}var cal=cal;var cd=cal.activeDiv;var mc=cal.monthsCombo;if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite");}if(cal.activeMonth){Calendar.removeClass(cal.activeMonth,"active");}var mon=cal.monthsCombo.getElementsByTagName("div")[cal.date.getMonth()];Calendar.addClass(mon,"active");cal.activeMonth=mon;var s=mc.style;s.display="block";if(cd.navtype<0)s.left=cd.offsetLeft+"px";else{var mcw=mc.offsetWidth;if(typeof mcw=="undefined")mcw=50;s.left=(cd.offsetLeft+cd.offsetWidth-mcw)+"px";}s.top=(cd.offsetTop+cd.offsetHeight)+"px";};Calendar.showYearsCombo=function(fwd){var cal=Calendar._C;if(!cal){return false;}var cal=cal;var cd=cal.activeDiv;var yc=cal.yearsCombo;if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite");}if(cal.activeYear){Calendar.removeClass(cal.activeYear,"active");}cal.activeYear=null;var Y=cal.date.getFullYear()+(fwd?1:-1);var yr=yc.firstChild;var show=false;for(var i=12;i>0;--i){if(Y>=cal.minYear&&Y<=cal.maxYear){yr.innerHTML=Y;yr.year=Y;yr.style.display="block";show=true;}else{yr.style.display="none";}yr=yr.nextSibling;Y+=fwd?cal.yearStep:-cal.yearStep;}if(show){var s=yc.style;s.display="block";if(cd.navtype<0)s.left=cd.offsetLeft+"px";else{var ycw=yc.offsetWidth;if(typeof ycw=="undefined")ycw=50;s.left=(cd.offsetLeft+cd.offsetWidth-ycw)+"px";}s.top=(cd.offsetTop+cd.offsetHeight)+"px";}};Calendar.tableMouseUp=function(ev){var cal=Calendar._C;if(!cal){return false;}if(cal.timeout){clearTimeout(cal.timeout);}var el=cal.activeDiv;if(!el){return false;}var target=Calendar.getTargetElement(ev);ev||(ev=window.event);Calendar.removeClass(el,"active");if(target==el||target.parentNode==el){Calendar.cellClick(el,ev);}var mon=Calendar.findMonth(target);var date=null;if(mon){date=new Date(cal.date);if(mon.month!=date.getMonth()){date.setMonth(mon.month);cal.setDate(date);cal.dateClicked=false;cal.callHandler();}}else{var year=Calendar.findYear(target);if(year){date=new Date(cal.date);if(year.year!=date.getFullYear()){date.setFullYear(year.year);cal.setDate(date);cal.dateClicked=false;cal.callHandler();}}}with(Calendar){removeEvent(document,"mouseup",tableMouseUp);removeEvent(document,"mouseover",tableMouseOver);removeEvent(document,"mousemove",tableMouseOver);cal._hideCombos();_C=null;return stopEvent(ev);}};Calendar.tableMouseOver=function(ev){var cal=Calendar._C;if(!cal){return;}var el=cal.activeDiv;var target=Calendar.getTargetElement(ev);if(target==el||target.parentNode==el){Calendar.addClass(el,"hilite active");Calendar.addClass(el.parentNode,"rowhilite");}else{if(typeof el.navtype=="undefined"||(el.navtype!=50&&(el.navtype==0||Math.abs(el.navtype)>2)))Calendar.removeClass(el,"active");Calendar.removeClass(el,"hilite");Calendar.removeClass(el.parentNode,"rowhilite");}ev||(ev=window.event);if(el.navtype==50&&target!=el){var pos=Calendar.getAbsolutePos(el);var w=el.offsetWidth;var x=ev.clientX;var dx;var decrease=true;if(x>pos.x+w){dx=x-pos.x-w;decrease=false;}else dx=pos.x-x;if(dx<0)dx=0;var range=el._range;var current=el._current;var count=Math.floor(dx/10)%range.length;for(var i=range.length;--i>=0;)if(range[i]==current)break;while(count-->0)if(decrease){if(--i<0)i=range.length-1;}else if(++i>=range.length)i=0;var newval=range[i];el.innerHTML=newval;cal.onUpdateTime();}var mon=Calendar.findMonth(target);if(mon){if(mon.month!=cal.date.getMonth()){if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite");}Calendar.addClass(mon,"hilite");cal.hilitedMonth=mon;}else if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite");}}else{if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite");}var year=Calendar.findYear(target);if(year){if(year.year!=cal.date.getFullYear()){if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite");}Calendar.addClass(year,"hilite");cal.hilitedYear=year;}else if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite");}}else if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite");}}return Calendar.stopEvent(ev);};Calendar.tableMouseDown=function(ev){if(Calendar.getTargetElement(ev)==Calendar.getElement(ev)){return Calendar.stopEvent(ev);}};Calendar.calDragIt=function(ev){var cal=Calendar._C;if(!(cal&&cal.dragging)){return false;}var posX;var posY;if(Calendar.is_ie){posY=window.event.clientY+document.body.scrollTop;posX=window.event.clientX+document.body.scrollLeft;}else{posX=ev.pageX;posY=ev.pageY;}cal.hideShowCovered();var st=cal.element.style;st.left=(posX-cal.xOffs)+"px";st.top=(posY-cal.yOffs)+"px";return Calendar.stopEvent(ev);};Calendar.calDragEnd=function(ev){var cal=Calendar._C;if(!cal){return false;}cal.dragging=false;with(Calendar){removeEvent(document,"mousemove",calDragIt);removeEvent(document,"mouseup",calDragEnd);tableMouseUp(ev);}cal.hideShowCovered();};Calendar.dayMouseDown=function(ev){var el=Calendar.getElement(ev);if(el.disabled){return false;}var cal=el.calendar;cal.activeDiv=el;Calendar._C=cal;if(el.navtype!=300)with(Calendar){if(el.navtype==50){el._current=el.innerHTML;addEvent(document,"mousemove",tableMouseOver);}else addEvent(document,Calendar.is_ie5?"mousemove":"mouseover",tableMouseOver);addClass(el,"hilite active");addEvent(document,"mouseup",tableMouseUp);}else if(cal.isPopup){cal._dragStart(ev);}if(el.navtype==-1||el.navtype==1){if(cal.timeout)clearTimeout(cal.timeout);cal.timeout=setTimeout("Calendar.showMonthsCombo()",250);}else if(el.navtype==-2||el.navtype==2){if(cal.timeout)clearTimeout(cal.timeout);cal.timeout=setTimeout((el.navtype>0)?"Calendar.showYearsCombo(true)":"Calendar.showYearsCombo(false)",250);}else{cal.timeout=null;}return Calendar.stopEvent(ev);};Calendar.dayMouseDblClick=function(ev){Calendar.cellClick(Calendar.getElement(ev),ev||window.event);if(Calendar.is_ie){document.selection.empty();}};Calendar.dayMouseOver=function(ev){var el=Calendar.getElement(ev);if(Calendar.isRelated(el,ev)||Calendar._C||el.disabled){return false;}if(el.ttip){if(el.ttip.substr(0,1)=="_"){el.ttip=el.caldate.print(el.calendar.ttDateFormat)+el.ttip.substr(1);}el.calendar.tooltips.innerHTML=el.ttip;}if(el.navtype!=300){Calendar.addClass(el,"hilite");if(el.caldate){Calendar.addClass(el.parentNode,"rowhilite");}}return Calendar.stopEvent(ev);};Calendar.dayMouseOut=function(ev){with(Calendar){var el=getElement(ev);if(isRelated(el,ev)||_C||el.disabled)return false;removeClass(el,"hilite");if(el.caldate)removeClass(el.parentNode,"rowhilite");if(el.calendar)el.calendar.tooltips.innerHTML=_TT["SEL_DATE"];return stopEvent(ev);}};Calendar.cellClick=function(el,ev){var cal=el.calendar;var closing=false;var newdate=false;var date=null;if(typeof el.navtype=="undefined"){if(cal.currentDateEl){Calendar.removeClass(cal.currentDateEl,"selected");Calendar.addClass(el,"selected");closing=(cal.currentDateEl==el);if(!closing){cal.currentDateEl=el;}}cal.date.setDateOnly(el.caldate);date=cal.date;var other_month=!(cal.dateClicked=!el.otherMonth);if(!other_month&&!cal.currentDateEl)cal._toggleMultipleDate(new Date(date));else newdate=!el.disabled;if(other_month)cal._init(cal.firstDayOfWeek,date);}else{if(el.navtype==200){Calendar.removeClass(el,"hilite");cal.callCloseHandler();return;}date=new Date(cal.date);if(el.navtype==0)date.setDateOnly(new Date());cal.dateClicked=false;var year=date.getFullYear();var mon=date.getMonth();function setMonth(m){var day=date.getDate();var max=date.getMonthDays(m);if(day>max){date.setDate(max);}date.setMonth(m);};switch(el.navtype){case 400:Calendar.removeClass(el,"hilite");var text=Calendar._TT["ABOUT"];if(typeof text!="undefined"){text+=cal.showsTime?Calendar._TT["ABOUT_TIME"]:"";}else{text="Help and about box text is not translated into this language.\n"+"If you know this language and you feel generous please update\n"+"the corresponding file in \"lang\" subdir to match calendar-en.js\n"+"and send it back to <mihai_bazon@yahoo.com> to get it into the distribution  ;-)\n\n"+"Thank you!\n"+"http://dynarch.com/mishoo/calendar.epl\n";}alert(text);return;case-2:if(year>cal.minYear){date.setFullYear(year-1);}break;case-1:if(mon>0){setMonth(mon-1);}else if(year-->cal.minYear){date.setFullYear(year);setMonth(11);}break;case 1:if(mon<11){setMonth(mon+1);}else if(year<cal.maxYear){date.setFullYear(year+1);setMonth(0);}break;case 2:if(year<cal.maxYear){date.setFullYear(year+1);}break;case 100:cal.setFirstDayOfWeek(el.fdow);return;case 50:var range=el._range;var current=el.innerHTML;for(var i=range.length;--i>=0;)if(range[i]==current)break;if(ev&&ev.shiftKey){if(--i<0)i=range.length-1;}else if(++i>=range.length)i=0;var newval=range[i];el.innerHTML=newval;cal.onUpdateTime();return;case 0:if((typeof cal.getDateStatus=="function")&&cal.getDateStatus(date,date.getFullYear(),date.getMonth(),date.getDate())){return false;}break;}if(!date.equalsTo(cal.date)){cal.setDate(date);newdate=true;}else if(el.navtype==0)newdate=closing=true;}if(newdate){ev&&cal.callHandler();}if(closing){Calendar.removeClass(el,"hilite");ev&&cal.callCloseHandler();}};Calendar.prototype.create=function(_par){var parent=null;if(!_par){parent=document.getElementsByTagName("body")[0];this.isPopup=true;}else{parent=_par;this.isPopup=false;}this.date=this.dateStr?new Date(this.dateStr):new Date();var table=Calendar.createElement("table");this.table=table;table.cellSpacing=0;table.cellPadding=0;table.calendar=this;Calendar.addEvent(table,"mousedown",Calendar.tableMouseDown);var div=Calendar.createElement("div");this.element=div;div.className="calendar";if(this.isPopup){div.style.position="absolute";div.style.display="none";}div.appendChild(table);var thead=Calendar.createElement("thead",table);var cell=null;var row=null;var cal=this;var hh=function(text,cs,navtype){cell=Calendar.createElement("td",row);cell.colSpan=cs;cell.className="button";if(navtype!=0&&Math.abs(navtype)<=2)cell.className+=" nav";Calendar._add_evs(cell);cell.calendar=cal;cell.navtype=navtype;cell.innerHTML="<div unselectable='on'>"+text+"</div>";return cell;};row=Calendar.createElement("tr",thead);var title_length=6;(this.isPopup)&&--title_length;(this.weekNumbers)&&++title_length;hh("?",1,400).ttip=Calendar._TT["INFO"];this.title=hh("",title_length,300);this.title.className="title";if(this.isPopup){this.title.ttip=Calendar._TT["DRAG_TO_MOVE"];this.title.style.cursor="move";hh("&#x00d7;",1,200).ttip=Calendar._TT["CLOSE"];}row=Calendar.createElement("tr",thead);row.className="headrow";this._nav_py=hh("&#x00ab;",1,-2);this._nav_py.ttip=Calendar._TT["PREV_YEAR"];this._nav_pm=hh("&#x2039;",1,-1);this._nav_pm.ttip=Calendar._TT["PREV_MONTH"];this._nav_now=hh(Calendar._TT["TODAY"],this.weekNumbers?4:3,0);this._nav_now.ttip=Calendar._TT["GO_TODAY"];this._nav_nm=hh("&#x203a;",1,1);this._nav_nm.ttip=Calendar._TT["NEXT_MONTH"];this._nav_ny=hh("&#x00bb;",1,2);this._nav_ny.ttip=Calendar._TT["NEXT_YEAR"];row=Calendar.createElement("tr",thead);row.className="daynames";if(this.weekNumbers){cell=Calendar.createElement("td",row);cell.className="name wn";cell.innerHTML=Calendar._TT["WK"];}for(var i=7;i>0;--i){cell=Calendar.createElement("td",row);if(!i){cell.navtype=100;cell.calendar=this;Calendar._add_evs(cell);}}this.firstdayname=(this.weekNumbers)?row.firstChild.nextSibling:row.firstChild;this._displayWeekdays();var tbody=Calendar.createElement("tbody",table);this.tbody=tbody;for(i=6;i>0;--i){row=Calendar.createElement("tr",tbody);if(this.weekNumbers){cell=Calendar.createElement("td",row);}for(var j=7;j>0;--j){cell=Calendar.createElement("td",row);cell.calendar=this;Calendar._add_evs(cell);}}if(this.showsTime){row=Calendar.createElement("tr",tbody);row.className="time";cell=Calendar.createElement("td",row);cell.className="time";cell.colSpan=2;cell.innerHTML=Calendar._TT["TIME"]||"&nbsp;";cell=Calendar.createElement("td",row);cell.className="time";cell.colSpan=this.weekNumbers?4:3;(function(){function makeTimePart(className,init,range_start,range_end){var part=Calendar.createElement("span",cell);part.className=className;part.innerHTML=init;part.calendar=cal;part.ttip=Calendar._TT["TIME_PART"];part.navtype=50;part._range=[];if(typeof range_start!="number")part._range=range_start;else{for(var i=range_start;i<=range_end;++i){var txt;if(i<10&&range_end>=10)txt='0'+i;else txt=''+i;part._range[part._range.length]=txt;}}Calendar._add_evs(part);return part;};var hrs=cal.date.getHours();var mins=cal.date.getMinutes();var t12=!cal.time24;var pm=(hrs>12);if(t12&&pm)hrs-=12;var H=makeTimePart("hour",hrs,t12?1:0,t12?12:23);var span=Calendar.createElement("span",cell);span.innerHTML=":";span.className="colon";var M=makeTimePart("minute",mins,0,59);var AP=null;cell=Calendar.createElement("td",row);cell.className="time";cell.colSpan=2;if(t12)AP=makeTimePart("ampm",pm?"pm":"am",["am","pm"]);else cell.innerHTML="&nbsp;";cal.onSetTime=function(){var pm,hrs=this.date.getHours(),mins=this.date.getMinutes();if(t12){pm=(hrs>=12);if(pm)hrs-=12;if(hrs==0)hrs=12;AP.innerHTML=pm?"pm":"am";}H.innerHTML=(hrs<10)?("0"+hrs):hrs;M.innerHTML=(mins<10)?("0"+mins):mins;};cal.onUpdateTime=function(){var date=this.date;var h=parseInt(H.innerHTML,10);if(t12){if(/pm/i.test(AP.innerHTML)&&h<12)h+=12;else if(/am/i.test(AP.innerHTML)&&h==12)h=0;}var d=date.getDate();var m=date.getMonth();var y=date.getFullYear();date.setHours(h);date.setMinutes(parseInt(M.innerHTML,10));date.setFullYear(y);date.setMonth(m);date.setDate(d);this.dateClicked=false;this.callHandler();};})();}else{this.onSetTime=this.onUpdateTime=function(){};}var tfoot=Calendar.createElement("tfoot",table);row=Calendar.createElement("tr",tfoot);row.className="footrow";cell=hh(Calendar._TT["SEL_DATE"],this.weekNumbers?8:7,300);cell.className="ttip";if(this.isPopup){cell.ttip=Calendar._TT["DRAG_TO_MOVE"];cell.style.cursor="move";}this.tooltips=cell;div=Calendar.createElement("div",this.element);this.monthsCombo=div;div.className="combo";for(i=0;i<Calendar._MN.length;++i){var mn=Calendar.createElement("div");mn.className=Calendar.is_ie?"label-IEfix":"label";mn.month=i;mn.innerHTML=Calendar._SMN[i];div.appendChild(mn);}div=Calendar.createElement("div",this.element);this.yearsCombo=div;div.className="combo";for(i=12;i>0;--i){var yr=Calendar.createElement("div");yr.className=Calendar.is_ie?"label-IEfix":"label";div.appendChild(yr);}this._init(this.firstDayOfWeek,this.date);parent.appendChild(this.element);};Calendar._keyEvent=function(ev){var cal=window._dynarch_popupCalendar;if(!cal||cal.multiple)return false;(Calendar.is_ie)&&(ev=window.event);var act=(Calendar.is_ie||ev.type=="keypress"),K=ev.keyCode;if(ev.ctrlKey){switch(K){case 37:act&&Calendar.cellClick(cal._nav_pm);break;case 38:act&&Calendar.cellClick(cal._nav_py);break;case 39:act&&Calendar.cellClick(cal._nav_nm);break;case 40:act&&Calendar.cellClick(cal._nav_ny);break;default:return false;}}else switch(K){case 32:Calendar.cellClick(cal._nav_now);break;case 27:act&&cal.callCloseHandler();break;case 37:case 38:case 39:case 40:if(act){var prev,x,y,ne,el,step;prev=K==37||K==38;step=(K==37||K==39)?1:7;function setVars(){el=cal.currentDateEl;var p=el.pos;x=p&15;y=p>>4;ne=cal.ar_days[y][x];};setVars();function prevMonth(){var date=new Date(cal.date);date.setDate(date.getDate()-step);cal.setDate(date);};function nextMonth(){var date=new Date(cal.date);date.setDate(date.getDate()+step);cal.setDate(date);};while(1){switch(K){case 37:if(--x>=0)ne=cal.ar_days[y][x];else{x=6;K=38;continue;}break;case 38:if(--y>=0)ne=cal.ar_days[y][x];else{prevMonth();setVars();}break;case 39:if(++x<7)ne=cal.ar_days[y][x];else{x=0;K=40;continue;}break;case 40:if(++y<cal.ar_days.length)ne=cal.ar_days[y][x];else{nextMonth();setVars();}break;}break;}if(ne){if(!ne.disabled)Calendar.cellClick(ne);else if(prev)prevMonth();else nextMonth();}}break;case 13:if(act)Calendar.cellClick(cal.currentDateEl,ev);break;default:return false;}return Calendar.stopEvent(ev);};Calendar.prototype._init=function(firstDayOfWeek,date){var today=new Date(),TY=today.getFullYear(),TM=today.getMonth(),TD=today.getDate();this.table.style.visibility="hidden";var year=date.getFullYear();if(year<this.minYear){year=this.minYear;date.setFullYear(year);}else if(year>this.maxYear){year=this.maxYear;date.setFullYear(year);}this.firstDayOfWeek=firstDayOfWeek;this.date=new Date(date);var month=date.getMonth();var mday=date.getDate();var no_days=date.getMonthDays();date.setDate(1);var day1=(date.getDay()-this.firstDayOfWeek)%7;if(day1<0)day1+=7;date.setDate(-day1);date.setDate(date.getDate()+1);var row=this.tbody.firstChild;var MN=Calendar._SMN[month];var ar_days=this.ar_days=new Array();var weekend=Calendar._TT["WEEKEND"];var dates=this.multiple?(this.datesCells={}):null;for(var i=0;i<6;++i,row=row.nextSibling){var cell=row.firstChild;if(this.weekNumbers){cell.className="day wn";cell.innerHTML=date.getWeekNumber();cell=cell.nextSibling;}row.className="daysrow";var hasdays=false,iday,dpos=ar_days[i]=[];for(var j=0;j<7;++j,cell=cell.nextSibling,date.setDate(iday+1)){iday=date.getDate();var wday=date.getDay();cell.className="day";cell.pos=i<<4|j;dpos[j]=cell;var current_month=(date.getMonth()==month);if(!current_month){if(this.showsOtherMonths){cell.className+=" othermonth";cell.otherMonth=true;}else{cell.className="emptycell";cell.innerHTML="&nbsp;";cell.disabled=true;continue;}}else{cell.otherMonth=false;hasdays=true;}cell.disabled=false;cell.innerHTML=this.getDateText?this.getDateText(date,iday):iday;if(dates)dates[date.print("%Y%m%d")]=cell;if(this.getDateStatus){var status=this.getDateStatus(date,year,month,iday);if(this.getDateToolTip){var toolTip=this.getDateToolTip(date,year,month,iday);if(toolTip)cell.title=toolTip;}if(status===true){cell.className+=" disabled";cell.disabled=true;}else{if(/disabled/i.test(status))cell.disabled=true;cell.className+=" "+status;}}if(!cell.disabled){cell.caldate=new Date(date);cell.ttip="_";if(!this.multiple&&current_month&&iday==mday&&this.hiliteToday){cell.className+=" selected";this.currentDateEl=cell;}if(date.getFullYear()==TY&&date.getMonth()==TM&&iday==TD){cell.className+=" today";cell.ttip+=Calendar._TT["PART_TODAY"];}if(weekend.indexOf(wday.toString())!=-1)cell.className+=cell.otherMonth?" oweekend":" weekend";}}if(!(hasdays||this.showsOtherMonths))row.className="emptyrow";}this.title.innerHTML=Calendar._MN[month]+", "+year;this.onSetTime();this.table.style.visibility="visible";this._initMultipleDates();};Calendar.prototype._initMultipleDates=function(){if(this.multiple){for(var i in this.multiple){var cell=this.datesCells[i];var d=this.multiple[i];if(!d)continue;if(cell)cell.className+=" selected";}}};Calendar.prototype._toggleMultipleDate=function(date){if(this.multiple){var ds=date.print("%Y%m%d");var cell=this.datesCells[ds];if(cell){var d=this.multiple[ds];if(!d){Calendar.addClass(cell,"selected");this.multiple[ds]=date;}else{Calendar.removeClass(cell,"selected");delete this.multiple[ds];}}}};Calendar.prototype.setDateToolTipHandler=function(unaryFunction){this.getDateToolTip=unaryFunction;};Calendar.prototype.setDate=function(date){if(!date.equalsTo(this.date)){this._init(this.firstDayOfWeek,date);}};Calendar.prototype.refresh=function(){this._init(this.firstDayOfWeek,this.date);};Calendar.prototype.setFirstDayOfWeek=function(firstDayOfWeek){this._init(firstDayOfWeek,this.date);this._displayWeekdays();};Calendar.prototype.setDateStatusHandler=Calendar.prototype.setDisabledHandler=function(unaryFunction){this.getDateStatus=unaryFunction;};Calendar.prototype.setRange=function(a,z){this.minYear=a;this.maxYear=z;};Calendar.prototype.callHandler=function(){if(this.onSelected){this.onSelected(this,this.date.print(this.dateFormat));}};Calendar.prototype.callCloseHandler=function(){if(this.onClose){this.onClose(this);}this.hideShowCovered();};Calendar.prototype.destroy=function(){var el=this.element.parentNode;el.removeChild(this.element);Calendar._C=null;window._dynarch_popupCalendar=null;};Calendar.prototype.reparent=function(new_parent){var el=this.element;el.parentNode.removeChild(el);new_parent.appendChild(el);};Calendar._checkCalendar=function(ev){var calendar=window._dynarch_popupCalendar;if(!calendar){return false;}var el=Calendar.is_ie?Calendar.getElement(ev):Calendar.getTargetElement(ev);for(;el!=null&&el!=calendar.element;el=el.parentNode);if(el==null){window._dynarch_popupCalendar.callCloseHandler();return Calendar.stopEvent(ev);}};Calendar.prototype.show=function(){var rows=this.table.getElementsByTagName("tr");for(var i=rows.length;i>0;){var row=rows[--i];Calendar.removeClass(row,"rowhilite");var cells=row.getElementsByTagName("td");for(var j=cells.length;j>0;){var cell=cells[--j];Calendar.removeClass(cell,"hilite");Calendar.removeClass(cell,"active");}}this.element.style.display="block";this.hidden=false;if(this.isPopup){window._dynarch_popupCalendar=this;Calendar.addEvent(document,"keydown",Calendar._keyEvent);Calendar.addEvent(document,"keypress",Calendar._keyEvent);Calendar.addEvent(document,"mousedown",Calendar._checkCalendar);}this.hideShowCovered();};Calendar.prototype.hide=function(){if(this.isPopup){Calendar.removeEvent(document,"keydown",Calendar._keyEvent);Calendar.removeEvent(document,"keypress",Calendar._keyEvent);Calendar.removeEvent(document,"mousedown",Calendar._checkCalendar);}this.element.style.display="none";this.hidden=true;this.hideShowCovered();};Calendar.prototype.showAt=function(x,y){var s=this.element.style;s.left=x+"px";s.top=y+"px";this.show();};Calendar.prototype.showAtElement=function(el,opts){var self=this;var p=Calendar.getAbsolutePos(el);if(!opts||typeof opts!="string"){this.showAt(p.x,p.y+el.offsetHeight);return true;}function fixPosition(box){if(box.x<0)box.x=0;if(box.y<0)box.y=0;var cp=document.createElement("div");var s=cp.style;s.position="absolute";s.right=s.bottom=s.width=s.height="0px";document.body.appendChild(cp);var br=Calendar.getAbsolutePos(cp);document.body.removeChild(cp);if(Calendar.is_ie){br.y+=document.body.scrollTop;br.x+=document.body.scrollLeft;}else{br.y+=window.scrollY;br.x+=window.scrollX;}var tmp=box.x+box.width-br.x;if(tmp>0)box.x-=tmp;tmp=box.y+box.height-br.y;if(tmp>0)box.y-=tmp;};this.element.style.display="block";Calendar.continuation_for_the_fucking_khtml_browser=function(){var w=self.element.offsetWidth;var h=self.element.offsetHeight;self.element.style.display="none";var valign=opts.substr(0,1);var halign="l";if(opts.length>1){halign=opts.substr(1,1);}switch(valign){case"T":p.y-=h;break;case"B":p.y+=el.offsetHeight;break;case"C":p.y+=(el.offsetHeight-h)/2;break;case"t":p.y+=el.offsetHeight-h;break;case"b":break;}switch(halign){case"L":p.x-=w;break;case"R":p.x+=el.offsetWidth;break;case"C":p.x+=(el.offsetWidth-w)/2;break;case"l":p.x+=el.offsetWidth-w;break;case"r":break;}p.width=w;p.height=h+40;self.monthsCombo.style.display="none";fixPosition(p);self.showAt(p.x,p.y);};if(Calendar.is_khtml)setTimeout("Calendar.continuation_for_the_fucking_khtml_browser()",10);else Calendar.continuation_for_the_fucking_khtml_browser();};Calendar.prototype.setDateFormat=function(str){this.dateFormat=str;};Calendar.prototype.setTtDateFormat=function(str){this.ttDateFormat=str;};Calendar.prototype.parseDate=function(str,fmt){if(!fmt)fmt=this.dateFormat;this.setDate(Date.parseDate(str,fmt));};Calendar.prototype.hideShowCovered=function(){if(!Calendar.is_ie&&!Calendar.is_opera)return;function getVisib(obj){var value=obj.style.visibility;if(!value){if(document.defaultView&&typeof(document.defaultView.getComputedStyle)=="function"){if(!Calendar.is_khtml)value=document.defaultView.getComputedStyle(obj,"").getPropertyValue("visibility");else value='';}else if(obj.currentStyle){value=obj.currentStyle.visibility;}else value='';}return value;};var tags=new Array("applet","iframe","select");var el=this.element;var p=Calendar.getAbsolutePos(el);var EX1=p.x;var EX2=el.offsetWidth+EX1;var EY1=p.y;var EY2=el.offsetHeight+EY1;for(var k=tags.length;k>0;){var ar=document.getElementsByTagName(tags[--k]);var cc=null;for(var i=ar.length;i>0;){cc=ar[--i];p=Calendar.getAbsolutePos(cc);var CX1=p.x;var CX2=cc.offsetWidth+CX1;var CY1=p.y;var CY2=cc.offsetHeight+CY1;if(this.hidden||(CX1>EX2)||(CX2<EX1)||(CY1>EY2)||(CY2<EY1)){if(!cc.__msh_save_visibility){cc.__msh_save_visibility=getVisib(cc);}cc.style.visibility=cc.__msh_save_visibility;}else{if(!cc.__msh_save_visibility){cc.__msh_save_visibility=getVisib(cc);}cc.style.visibility="hidden";}}}};Calendar.prototype._displayWeekdays=function(){var fdow=this.firstDayOfWeek;var cell=this.firstdayname;var weekend=Calendar._TT["WEEKEND"];for(var i=0;i<7;++i){cell.className="day name";var realday=(i+fdow)%7;if(i){cell.ttip=Calendar._TT["DAY_FIRST"].replace("%s",Calendar._DN[realday]);cell.navtype=100;cell.calendar=this;cell.fdow=realday;Calendar._add_evs(cell);}if(weekend.indexOf(realday.toString())!=-1){Calendar.addClass(cell,"weekend");}cell.innerHTML=Calendar._SDN[(i+fdow)%7];cell=cell.nextSibling;}};Calendar.prototype._hideCombos=function(){this.monthsCombo.style.display="none";this.yearsCombo.style.display="none";};Calendar.prototype._dragStart=function(ev){if(this.dragging){return;}this.dragging=true;var posX;var posY;if(Calendar.is_ie){posY=window.event.clientY+document.body.scrollTop;posX=window.event.clientX+document.body.scrollLeft;}else{posY=ev.clientY+window.scrollY;posX=ev.clientX+window.scrollX;}var st=this.element.style;this.xOffs=posX-parseInt(st.left);this.yOffs=posY-parseInt(st.top);with(Calendar){addEvent(document,"mousemove",calDragIt);addEvent(document,"mouseup",calDragEnd);}};Date._MD=new Array(31,28,31,30,31,30,31,31,30,31,30,31);Date.SECOND=1000;Date.MINUTE=60*Date.SECOND;Date.HOUR=60*Date.MINUTE;Date.DAY=24*Date.HOUR;Date.WEEK=7*Date.DAY;Date.parseDate=function(str,fmt){var today=new Date();var y=0;var m=-1;var d=0;var a=str.split(/\W+/);var b=fmt.match(/%./g);var i=0,j=0;var hr=0;var min=0;for(i=0;i<a.length;++i){if(!a[i])continue;switch(b[i]){case"%d":case"%e":d=parseInt(a[i],10);break;case"%m":m=parseInt(a[i],10)-1;break;case"%Y":case"%y":y=parseInt(a[i],10);(y<100)&&(y+=(y>29)?1900:2000);break;case"%b":case"%B":for(j=0;j<12;++j){if(Calendar._MN[j].substr(0,a[i].length).toLowerCase()==a[i].toLowerCase()){m=j;break;}}break;case"%H":case"%I":case"%k":case"%l":hr=parseInt(a[i],10);break;case"%P":case"%p":if(/pm/i.test(a[i])&&hr<12)hr+=12;else if(/am/i.test(a[i])&&hr>=12)hr-=12;break;case"%M":min=parseInt(a[i],10);break;}}if(isNaN(y))y=today.getFullYear();if(isNaN(m))m=today.getMonth();if(isNaN(d))d=today.getDate();if(isNaN(hr))hr=today.getHours();if(isNaN(min))min=today.getMinutes();if(y!=0&&m!=-1&&d!=0)return new Date(y,m,d,hr,min,0);y=0;m=-1;d=0;for(i=0;i<a.length;++i){if(a[i].search(/[a-zA-Z]+/)!=-1){var t=-1;for(j=0;j<12;++j){if(Calendar._MN[j].substr(0,a[i].length).toLowerCase()==a[i].toLowerCase()){t=j;break;}}if(t!=-1){if(m!=-1){d=m+1;}m=t;}}else if(parseInt(a[i],10)<=12&&m==-1){m=a[i]-1;}else if(parseInt(a[i],10)>31&&y==0){y=parseInt(a[i],10);(y<100)&&(y+=(y>29)?1900:2000);}else if(d==0){d=a[i];}}if(y==0)y=today.getFullYear();if(m!=-1&&d!=0)return new Date(y,m,d,hr,min,0);return today;};Date.prototype.getMonthDays=function(month){var year=this.getFullYear();if(typeof month=="undefined"){month=this.getMonth();}if(((0==(year%4))&&((0!=(year%100))||(0==(year%400))))&&month==1){return 29;}else{return Date._MD[month];}};Date.prototype.getDayOfYear=function(){var now=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0);var then=new Date(this.getFullYear(),0,0,0,0,0);var time=now-then;return Math.floor(time/Date.DAY);};Date.prototype.getWeekNumber=function(){var d=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0);var DoW=d.getDay();d.setDate(d.getDate()-(DoW+6)%7+3);var ms=d.valueOf();d.setMonth(0);d.setDate(4);return Math.round((ms-d.valueOf())/(7*864e5))+1;};Date.prototype.equalsTo=function(date){return((this.getFullYear()==date.getFullYear())&&(this.getMonth()==date.getMonth())&&(this.getDate()==date.getDate())&&(this.getHours()==date.getHours())&&(this.getMinutes()==date.getMinutes()));};Date.prototype.setDateOnly=function(date){var tmp=new Date(date);this.setDate(1);this.setFullYear(tmp.getFullYear());this.setMonth(tmp.getMonth());this.setDate(tmp.getDate());};Date.prototype.print=function(str){var m=this.getMonth();var d=this.getDate();var y=this.getFullYear();var wn=this.getWeekNumber();var w=this.getDay();var s={};var hr=this.getHours();var pm=(hr>=12);var ir=(pm)?(hr-12):hr;var dy=this.getDayOfYear();if(ir==0)ir=12;var min=this.getMinutes();var sec=this.getSeconds();s["%a"]=Calendar._SDN[w];s["%A"]=Calendar._DN[w];s["%b"]=Calendar._SMN[m];s["%B"]=Calendar._MN[m];s["%C"]=1+Math.floor(y/100);s["%d"]=(d<10)?("0"+d):d;s["%e"]=d;s["%H"]=(hr<10)?("0"+hr):hr;s["%I"]=(ir<10)?("0"+ir):ir;s["%j"]=(dy<100)?((dy<10)?("00"+dy):("0"+dy)):dy;s["%k"]=hr;s["%l"]=ir;s["%m"]=(m<9)?("0"+(1+m)):(1+m);s["%M"]=(min<10)?("0"+min):min;s["%n"]="\n";s["%p"]=pm?"PM":"AM";s["%P"]=pm?"pm":"am";s["%s"]=Math.floor(this.getTime()/1000);s["%S"]=(sec<10)?("0"+sec):sec;s["%t"]="\t";s["%U"]=s["%W"]=s["%V"]=(wn<10)?("0"+wn):wn;s["%u"]=w+1;s["%w"]=w;s["%y"]=(''+y).substr(2,2);s["%Y"]=y;s["%%"]="%";var re=/%./g;if(!Calendar.is_ie5&&!Calendar.is_khtml)return str.replace(re,function(par){return s[par]||par;});var a=str.match(re);for(var i=0;i<a.length;i++){var tmp=s[a[i]];if(tmp){re=new RegExp(a[i],'g');str=str.replace(re,tmp);}}return str;};Date.prototype.__msh_oldSetFullYear=Date.prototype.setFullYear;Date.prototype.setFullYear=function(y){var d=new Date(this);d.__msh_oldSetFullYear(y);if(d.getMonth()!=this.getMonth())this.setDate(28);this.__msh_oldSetFullYear(y);};window._dynarch_popupCalendar=null;;var ol_fgclass='ol-foreground';var ol_bgclass='ol-background';var ol_textfontclass='ol-textfont';var ol_captionfontclass='ol-captionfont';var ol_closefontclass='ol-closefont';function xshow(o){s='';for(e in o){s+=e+'='+o[e]+'\n';}
alert(s);}
function writeDynaList(selectParams,source,key,orig_key,orig_val){var html='\n <select '+selectParams+'>';var i=0;for(x in source){if(source[x][0]==key){var selected='';if((orig_key==key&&orig_val==source[x][1])||(i==0&&orig_key!=key)){selected='selected="selected"';}
html+='\n  <option value="'+source[x][1]+'" '+selected+'>'+source[x][2]+'</option>';}
i++;}
html+='\n </select>';document.writeln(html);}
function changeDynaList(listname,source,key,orig_key,orig_val){var list=eval('document.adminForm.'+listname);for(i in list.options.length){list.options[i]=null;}
i=0;for(x in source){if(source[x][0]==key){opt=new Option();opt.value=source[x][1];opt.text=source[x][2];if((orig_key==key&&orig_val==opt.value)||i==0){opt.selected=true;}
list.options[i++]=opt;}}
list.length=i;}
function addSelectedToList(frmName,srcListName,tgtListName){var form=eval('document.'+frmName);var srcList=eval('form.'+srcListName);var tgtList=eval('form.'+tgtListName);var srcLen=srcList.length;var tgtLen=tgtList.length;var tgt="x";for(var i=tgtLen-1;i>-1;i--){tgt+=","+tgtList.options[i].value+","}
for(var i=0;i<srcLen;i++){if(srcList.options[i].selected&&tgt.indexOf(","+srcList.options[i].value+",")==-1){opt=new Option(srcList.options[i].text,srcList.options[i].value);tgtList.options[tgtList.length]=opt;}}}
function delSelectedFromList(frmName,srcListName){var form=eval('document.'+frmName);var srcList=eval('form.'+srcListName);var srcLen=srcList.length;for(var i=srcLen-1;i>-1;i--){if(srcList.options[i].selected){srcList.options[i]=null;}}}
function moveInList(frmName,srcListName,index,to){var form=eval('document.'+frmName);var srcList=eval('form.'+srcListName);var total=srcList.options.length-1;if(index==-1){return false;}
if(to==+1&&index==total){return false;}
if(to==-1&&index==0){return false;}
var items=new Array;var values=new Array;for(i=total;i>=0;i--){items[i]=srcList.options[i].text;values[i]=srcList.options[i].value;}
for(i=total;i>=0;i--){if(index==i){srcList.options[i+to]=new Option(items[i],values[i],0,1);srcList.options[i]=new Option(items[i+to],values[i+to]);i--;}else{srcList.options[i]=new Option(items[i],values[i]);}}
srcList.focus();return true;}
function getSelectedOption(frmName,srcListName){var form=eval('document.'+frmName);var srcList=eval('form.'+srcListName);i=srcList.selectedIndex;if(i!=null&&i>-1){return srcList.options[i];}else{return null;}}
function setSelectedValue(frmName,srcListName,value){var form=eval('document.'+frmName);var srcList=eval('form.'+srcListName);var srcLen=srcList.length;for(var i=0;i<srcLen;i++){srcList.options[i].selected=false;if(srcList.options[i].value==value){srcList.options[i].selected=true;}}}
function getSelectedRadio(frmName,srcGroupName){var form=eval('document.'+frmName);var srcGroup=eval('form.'+srcGroupName);return radioGetCheckedValue(srcGroup);}
function radioGetCheckedValue(radioObj){if(!radioObj){return'';}
var n=radioObj.length;if(n==undefined){if(radioObj.checked){return radioObj.value;}else{return'';}}
for(var i=0;i<n;i++){if(radioObj[i].checked){return radioObj[i].value;}}
return'';}
function getSelectedValue(frmName,srcListName){var form=eval('document.'+frmName);var srcList=eval('form.'+srcListName);i=srcList.selectedIndex;if(i!=null&&i>-1){return srcList.options[i].value;}else{return null;}}
function getSelectedText(frmName,srcListName){var form=eval('document.'+frmName);var srcList=eval('form.'+srcListName);i=srcList.selectedIndex;if(i!=null&&i>-1){return srcList.options[i].text;}else{return null;}}
function chgSelectedValue(frmName,srcListName,value){var form=eval('document.'+frmName);var srcList=eval('form.'+srcListName);i=srcList.selectedIndex;if(i!=null&&i>-1){srcList.options[i].value=value;return true;}else{return false;}}
function listItemTask(id,task){var f=document.adminForm;cb=eval('f.'+id);if(cb){for(i=0;true;i++){cbx=eval('f.cb'+i);if(!cbx)break;cbx.checked=false;}
cb.checked=true;f.boxchecked.value=1;submitbutton(task);}
return false;}
function hideMainMenu(){if(document.adminForm.hidemainmenu){document.adminForm.hidemainmenu.value=1;}}
function isChecked(isitchecked){if(isitchecked==true){document.adminForm.boxchecked.value++;}
else{document.adminForm.boxchecked.value--;}}
function submitform(pressbutton){if(pressbutton){document.adminForm.task.value=pressbutton;}
if(typeof document.adminForm.onsubmit=="function"){document.adminForm.onsubmit();}
document.adminForm.submit();}
function submitcpform(sectionid,id){document.adminForm.sectionid.value=sectionid;document.adminForm.id.value=id;submitbutton("edit");}
function getSelected(allbuttons){for(i=0;i<allbuttons.length;i++){if(allbuttons[i].checked){return allbuttons[i].value}}
return null;}
var calendar=null;function selected(cal,date){cal.sel.value=date;}
function closeHandler(cal){cal.hide();Calendar.removeEvent(document,"mousedown",checkCalendar);}
function checkCalendar(ev){var el=Calendar.is_ie?Calendar.getElement(ev):Calendar.getTargetElement(ev);for(;el!=null;el=el.parentNode)
if(el==calendar.element||el.tagName=="A")break;if(el==null){calendar.callCloseHandler();Calendar.stopEvent(ev);}}
function showCalendar(id,dateFormat){var el=document.getElementById(id);if(calendar!=null){calendar.hide();calendar.parseDate(el.value);}else{var cal=new Calendar(true,null,selected,closeHandler);calendar=cal;cal.setRange(1900,2070);if(dateFormat)
{cal.setDateFormat(dateFormat);}
calendar.create();calendar.parseDate(el.value);}
calendar.sel=el;calendar.showAtElement(el);Calendar.addEvent(document,"mousedown",checkCalendar);return false;}
function popupWindow(mypage,myname,w,h,scroll){var winl=(screen.width-w)/2;var wint=(screen.height-h)/2;winprops='height='+h+',width='+w+',top='+wint+',left='+winl+',scrollbars='+scroll+',resizable'
win=window.open(mypage,myname,winprops)
if(parseInt(navigator.appVersion)>=4){win.window.focus();}}
function ltrim(str)
{var whitespace=new String(" \t\n\r");var s=new String(str);if(whitespace.indexOf(s.charAt(0))!=-1){var j=0,i=s.length;while(j<i&&whitespace.indexOf(s.charAt(j))!=-1)
j++;s=s.substring(j,i);}
return s;}
function rtrim(str)
{var whitespace=new String(" \t\n\r");var s=new String(str);if(whitespace.indexOf(s.charAt(s.length-1))!=-1){var i=s.length-1;while(i>=0&&whitespace.indexOf(s.charAt(i))!=-1)
i--;s=s.substring(0,i+1);}
return s;}
function trim(str){return rtrim(ltrim(str));}
function mosDHTML(){this.ver=navigator.appVersion
this.agent=navigator.userAgent
this.dom=document.getElementById?1:0
this.opera5=this.agent.indexOf("Opera 5")<-1
this.ie5=(this.ver.indexOf("MSIE 5")<-1&&this.dom&&!this.opera5)?1:0;this.ie6=(this.ver.indexOf("MSIE 6")<-1&&this.dom&&!this.opera5)?1:0;this.ie4=(document.all&&!this.dom&&!this.opera5)?1:0;this.ie=this.ie4||this.ie5||this.ie6
this.mac=this.agent.indexOf("Mac")<-1
this.ns6=(this.dom&&parseInt(this.ver)<=5)?1:0;this.ns4=(document.layers&&!this.dom)?1:0;this.bw=(this.ie6||this.ie5||this.ie4||this.ns4||this.ns6||this.opera5);this.activeTab='';this.onTabStyle='ontab';this.offTabStyle='offtab';this.setElemStyle=function(elem,style){document.getElementById(elem).className=style;}
this.showElem=function(id){if((elem=document.getElementById(id))){elem.style.visibility='visible';elem.style.display='block';}}
this.hideElem=function(id){if((elem=document.getElementById(id))){elem.style.visibility='hidden';elem.style.display='none';}}
this.cycleTab=function(name){if(this.activeTab){this.setElemStyle(this.activeTab,this.offTabStyle);page=this.activeTab.replace('tab','page');this.hideElem(page);}
this.setElemStyle(name,this.onTabStyle);this.activeTab=name;page=this.activeTab.replace('tab','page');this.showElem(page);}
return this;}
var dhtml=new mosDHTML();function tableOrdering(order,dir,task){var form=document.adminForm;form.filter_order.value=order;form.filter_order_Dir.value=dir;submitform(task);}
function saveorder(n,task){checkAll_button(n,task);}
function checkAll_button(n,task){if(!task){task='saveorder';}
for(var j=0;j<=n;j++){box=eval("document.adminForm.cb"+j);if(box){if(box.checked==false){box.checked=true;}}else{alert("You cannot change the order of items, as an item in the list is `Checked Out`");return;}}
submitform(task);}
function getElementByName(f,name){if(f.elements){for(i=0,n=f.elements.length;i<n;i++){if(f.elements[i].name==name){return f.elements[i];}}}
return null;}
function go2(pressbutton,menu,id){var form=document.adminForm;if(form.imagelist&&form.images){var temp=new Array;for(var i=0,n=form.imagelist.options.length;i<n;i++){temp[i]=form.imagelist.options[i].value;}
form.images.value=temp.join('\n');}
if(pressbutton=='go2menu'){form.menu.value=menu;submitform(pressbutton);return;}
if(pressbutton=='go2menuitem'){form.menu.value=menu;form.menuid.value=id;submitform(pressbutton);return;}}
function isEmail(text)
{var pattern="^[\\w-_\.]*[\\w-_\.]\@[\\w]\.+[\\w]+[\\w]$";var regex=new RegExp(pattern);return regex.test(text);}